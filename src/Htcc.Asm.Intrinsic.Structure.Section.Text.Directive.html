<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Htcc.Asm.Intrinsic.Structure.Section.Text.Directive
Description : The modules of intrinsic (x86_64) assembly
Copyright   : (c) roki, 2019
License     : MIT
Maintainer  : falgon53@yahoo.co.jp
Stability   : experimental
Portability : POSIX

The modules of intrinsic (x86_64) assembly
-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, LambdaCase #-}</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Htcc.Asm.Intrinsic.Structure.Section.Text.Directive</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>    </span><span class="hs-comment">-- * Context type</span><span>
</span><a name="line-15"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextSectionCtx"><span class="hs-identifier hs-type">TextSectionCtx</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-comment">-- * Directives</span><span>
</span><a name="line-19"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#text"><span class="hs-identifier hs-var">text</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#global"><span class="hs-identifier hs-var">global</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>    </span><span class="hs-comment">-- * Labels</span><span>
</span><a name="line-22"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#fn"><span class="hs-identifier hs-var">fn</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>    </span><span class="hs-keyword">label</span><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#begin"><span class="hs-identifier hs-var">begin</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#end"><span class="hs-identifier hs-var">end</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#eLse"><span class="hs-identifier hs-var">eLse</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#cAse"><span class="hs-identifier hs-var">cAse</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#break"><span class="hs-identifier hs-var">break</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#continue"><span class="hs-identifier hs-var">continue</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#gotoLabel"><span class="hs-identifier hs-var">gotoLabel</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#ref"><span class="hs-identifier hs-var">ref</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refBegin"><span class="hs-identifier hs-var">refBegin</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refEnd"><span class="hs-identifier hs-var">refEnd</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refElse"><span class="hs-identifier hs-var">refElse</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refBreak"><span class="hs-identifier hs-var">refBreak</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refHBreak"><span class="hs-identifier hs-var">refHBreak</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refContinue"><span class="hs-identifier hs-var">refContinue</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refHContinue"><span class="hs-identifier hs-var">refHContinue</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refReturn"><span class="hs-identifier hs-var">refReturn</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refGoto"><span class="hs-identifier hs-var">refGoto</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-comment">-- * Generator</span><span>
</span><a name="line-42"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#makeCases"><span class="hs-identifier hs-var">makeCases</span></a><span>
</span><a name="line-43"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">break</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unless</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">forM</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.IO</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isJust</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.AST.Core.html"><span class="hs-identifier">Htcc.Parser.AST.Core</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATKind"><span class="hs-identifier hs-type">ATKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html"><span class="hs-identifier">Htcc.Asm.Intrinsic.Structure.Internal</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">C</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Utils.html"><span class="hs-identifier">Htcc.Utils</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- | the type representing the context inside the text section</span><span>
</span><a name="line-57"></a><span class="hs-keyword">data</span><span> </span><a name="TextSectionCtx"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextSectionCtx"><span class="hs-identifier">TextSectionCtx</span></a></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">-- | the type representing the context inside the label</span><span>
</span><a name="line-60"></a><span class="hs-keyword">data</span><span> </span><a name="TextLabelCtx"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier">TextLabelCtx</span></a></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | the type representing the context inside the instruction that needs to be specified,</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- such as a @jmp@ instruction.</span><span>
</span><a name="line-64"></a><span class="hs-keyword">data</span><span> </span><a name="TargetLabelCtx"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier">TargetLabelCtx</span></a></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-comment">-- | @text@ section</span><span>
</span><a name="line-67"></a><span class="hs-identifier">text</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextSectionCtx"><span class="hs-identifier hs-type">TextSectionCtx</span></a><span> </span><a href="#local-6989586621679177215"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679177216"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#AsmCodeCtx"><span class="hs-identifier hs-type">C.AsmCodeCtx</span></a><span> </span><a href="#local-6989586621679177215"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679177216"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-68"></a><a name="text"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#text"><span class="hs-identifier">text</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#section"><span class="hs-identifier hs-var">C.section</span></a><span> </span><span class="hs-string">&quot;text&quot;</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | @global@ directive</span><span>
</span><a name="line-71"></a><span class="hs-identifier">global</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextSectionCtx"><span class="hs-identifier hs-type">TextSectionCtx</span></a><span> </span><a href="#local-6989586621679177214"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><a name="global"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#global"><span class="hs-identifier">global</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#putStrLnWithIndent"><span class="hs-identifier hs-var">C.putStrLnWithIndent</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.append</span><span> </span><span class="hs-string">&quot;.global &quot;</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | the label as function definition in text section </span><span>
</span><a name="line-75"></a><span class="hs-identifier">fn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177212"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679177213"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextSectionCtx"><span class="hs-identifier hs-type">TextSectionCtx</span></a><span> </span><a href="#local-6989586621679177212"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679177213"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-76"></a><a name="fn"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#fn"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679177217"><a href="#local-6989586621679177217"><span class="hs-identifier">fname</span></a></a><span> </span><a name="local-6989586621679177218"><a href="#local-6989586621679177218"><span class="hs-identifier">asm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#writeCurFn"><span class="hs-identifier hs-var">C.writeCurFn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679177217"><span class="hs-identifier hs-var">fname</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span>
</span><a name="line-77"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#putStrLnWithIndent"><span class="hs-identifier hs-var">C.putStrLnWithIndent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177217"><span class="hs-identifier hs-var">fname</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span>
</span><a name="line-78"></a><span>    </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#unCtx"><span class="hs-identifier hs-var">C.unCtx</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#labeled"><span class="hs-identifier hs-var">C.labeled</span></a><span> </span><a href="#local-6989586621679177218"><span class="hs-identifier hs-var">asm</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- | the label in text section</span><span>
</span><a name="line-81"></a><span class="hs-keyword">label</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177210"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177211"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177210"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177211"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span class="hs-keyword">label</span><span> </span><a name="local-6989586621679177219"><a href="#local-6989586621679177219"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621679177220"><a href="#local-6989586621679177220"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177221"><a href="#local-6989586621679177221"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-83"></a><span>    </span><a name="local-6989586621679177222"><a href="#local-6989586621679177222"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177221"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177222"><span class="hs-identifier hs-var">cf</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;stray label&quot;</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;.L.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679177219"><span class="hs-identifier hs-var">lbl</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177222"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><a href="#local-6989586621679177220"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;:&quot;</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">-- | goto label</span><span>
</span><a name="line-88"></a><span class="hs-identifier">gotoLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177209"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-89"></a><a name="gotoLabel"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#gotoLabel"><span class="hs-identifier">gotoLabel</span></a></a><span> </span><a name="local-6989586621679177223"><a href="#local-6989586621679177223"><span class="hs-identifier">ident</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177224"><a href="#local-6989586621679177224"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-90"></a><span>    </span><a name="local-6989586621679177225"><a href="#local-6989586621679177225"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177224"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177225"><span class="hs-identifier hs-var">cf</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;stray goto label&quot;</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;.L.label.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177225"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679177223"><span class="hs-identifier hs-var">ident</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;:&quot;</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- | begin label</span><span>
</span><a name="line-95"></a><span class="hs-identifier">begin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177207"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177208"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177208"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177207"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><a name="begin"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#begin"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">label</span><span> </span><span class="hs-string">&quot;begin&quot;</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | end label</span><span>
</span><a name="line-99"></a><span class="hs-identifier">end</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177205"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177206"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177206"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177205"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><a name="end"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#end"><span class="hs-identifier">end</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">label</span><span> </span><span class="hs-string">&quot;end&quot;</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- | else label</span><span>
</span><a name="line-103"></a><span class="hs-identifier">eLse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177203"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177204"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177204"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177203"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><a name="eLse"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#eLse"><span class="hs-identifier">eLse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">label</span><span> </span><span class="hs-string">&quot;else&quot;</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | case label</span><span>
</span><a name="line-107"></a><span class="hs-identifier">cAse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177201"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177202"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177202"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177201"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><a name="cAse"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#cAse"><span class="hs-identifier">cAse</span></a></a><span> </span><a name="local-6989586621679177226"><a href="#local-6989586621679177226"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177227"><a href="#local-6989586621679177227"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-109"></a><span>    </span><a name="local-6989586621679177228"><a href="#local-6989586621679177228"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177227"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177228"><span class="hs-identifier hs-var">cf</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;stray case&quot;</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;.L.case.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177228"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><a href="#local-6989586621679177226"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;:&quot;</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- | break label</span><span>
</span><a name="line-114"></a><span class="hs-identifier">break</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177199"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177200"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177200"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177199"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><a name="break"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#break"><span class="hs-identifier">break</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">label</span><span> </span><span class="hs-string">&quot;break&quot;</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- | continue label</span><span>
</span><a name="line-118"></a><span class="hs-identifier">continue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177197"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177198"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177198"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177197"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><a name="continue"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#continue"><span class="hs-identifier">continue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">label</span><span> </span><span class="hs-string">&quot;continue&quot;</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | reference for return label</span><span>
</span><a name="line-122"></a><span class="hs-identifier">refReturn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177196"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177196"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><a name="refReturn"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refReturn"><span class="hs-identifier">refReturn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177229"><a href="#local-6989586621679177229"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-124"></a><span>    </span><a name="local-6989586621679177230"><a href="#local-6989586621679177230"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177229"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177230"><span class="hs-identifier hs-var">cf</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;stray label&quot;</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;.L.return.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177230"><span class="hs-identifier hs-var">cf</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-identifier">refCnt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177193"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#AsmInfo"><span class="hs-identifier hs-type">C.AsmInfo</span></a><span> </span><a href="#local-6989586621679177194"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679177193"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="#local-6989586621679177195"><span class="hs-identifier hs-type">ctx</span></a><span> </span><a href="#local-6989586621679177194"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><a name="refCnt"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refCnt"><span class="hs-identifier">refCnt</span></a></a><span> </span><a name="local-6989586621679177231"><a href="#local-6989586621679177231"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679177232"><a href="#local-6989586621679177232"><span class="hs-identifier">mes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177233"><a href="#local-6989586621679177233"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-130"></a><span>    </span><a name="local-6989586621679177234"><a href="#local-6989586621679177234"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177233"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177234"><span class="hs-identifier hs-var">cf</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;stray &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679177232"><span class="hs-identifier hs-var">mes</span></a><span>
</span><a name="line-132"></a><span>    </span><a name="local-6989586621679177235"><a href="#local-6989586621679177235"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177231"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679177233"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177235"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;stray &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679177232"><span class="hs-identifier hs-var">mes</span></a><span>
</span><a name="line-134"></a><span>    </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;.L.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679177232"><span class="hs-identifier hs-var">mes</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177234"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177235"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | reference for break label</span><span>
</span><a name="line-137"></a><span class="hs-identifier">refBreak</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177191"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177192"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177192"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177191"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><a name="refBreak"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refBreak"><span class="hs-identifier">refBreak</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#ref"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-string">&quot;break&quot;</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- | reference for break label (applying value by `Htcc.Asm.Intrinsic.Structure.Internal.brkCnt`)</span><span>
</span><a name="line-141"></a><span class="hs-identifier">refHBreak</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177190"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177190"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><a name="refHBreak"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refHBreak"><span class="hs-identifier">refHBreak</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refCnt"><span class="hs-identifier hs-var">refCnt</span></a><span> </span><span class="hs-identifier">C.brkCnt</span><span> </span><span class="hs-string">&quot;break&quot;</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- | reference for continue label</span><span>
</span><a name="line-145"></a><span class="hs-identifier">refContinue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177188"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177189"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177189"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177188"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><a name="refContinue"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refContinue"><span class="hs-identifier">refContinue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#ref"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-string">&quot;continue&quot;</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | reference for break label (applying value by `Htcc.Asm.Intrinsic.Structure.Internal.cntCnt`)</span><span>
</span><a name="line-149"></a><span class="hs-identifier">refHContinue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177187"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177187"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><a name="refHContinue"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refHContinue"><span class="hs-identifier">refHContinue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refCnt"><span class="hs-identifier hs-var">refCnt</span></a><span> </span><span class="hs-identifier">C.cntCnt</span><span> </span><span class="hs-string">&quot;continue&quot;</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | reference for goto label</span><span>
</span><a name="line-153"></a><span class="hs-identifier">refGoto</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177186"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><a name="refGoto"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refGoto"><span class="hs-identifier">refGoto</span></a></a><span> </span><a name="local-6989586621679177236"><a href="#local-6989586621679177236"><span class="hs-identifier">ident</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177237"><a href="#local-6989586621679177237"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-155"></a><span>    </span><a name="local-6989586621679177238"><a href="#local-6989586621679177238"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177237"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177238"><span class="hs-identifier hs-var">cf</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;stray label&quot;</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;.L.label.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177238"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679177236"><span class="hs-identifier hs-var">ident</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | reference to begin label</span><span>
</span><a name="line-160"></a><span class="hs-identifier">refBegin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177184"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177185"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177185"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177184"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><a name="refBegin"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refBegin"><span class="hs-identifier">refBegin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#ref"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-string">&quot;begin&quot;</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | reference to end label</span><span>
</span><a name="line-164"></a><span class="hs-identifier">refEnd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177182"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177183"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177183"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177182"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-165"></a><a name="refEnd"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refEnd"><span class="hs-identifier">refEnd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#ref"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-string">&quot;end&quot;</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | reference to else label</span><span>
</span><a name="line-168"></a><span class="hs-identifier">refElse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177180"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177181"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679177181"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177180"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><a name="refElse"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#refElse"><span class="hs-identifier">refElse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#ref"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-string">&quot;else&quot;</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | reference to general label</span><span>
</span><a name="line-172"></a><span class="hs-identifier">ref</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177178"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177179"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177179"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TargetLabelCtx"><span class="hs-identifier hs-type">TargetLabelCtx</span></a><span> </span><a href="#local-6989586621679177178"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-173"></a><a name="ref"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#ref"><span class="hs-identifier">ref</span></a></a><span> </span><a name="local-6989586621679177239"><a href="#local-6989586621679177239"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621679177240"><a href="#local-6989586621679177240"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177241"><a href="#local-6989586621679177241"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-174"></a><span>    </span><a name="local-6989586621679177242"><a href="#local-6989586621679177242"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177241"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679177242"><span class="hs-identifier hs-var">cf</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Print.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;stray label&quot;</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;.L.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679177239"><span class="hs-identifier hs-var">lbl</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177242"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><a href="#local-6989586621679177240"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- | generate cases and return abstract tree</span><span>
</span><a name="line-179"></a><span class="hs-identifier">makeCases</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177176"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679177176"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679177176"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177177"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679177177"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679177177"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-type">C.Asm</span></a><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#TextLabelCtx"><span class="hs-identifier hs-type">TextLabelCtx</span></a><span> </span><a href="#local-6989586621679177176"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679177177"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-180"></a><a name="makeCases"><a href="Htcc.Asm.Intrinsic.Structure.Section.Text.Directive.html#makeCases"><span class="hs-identifier">makeCases</span></a></a><span> </span><a name="local-6989586621679177243"><a href="#local-6989586621679177243"><span class="hs-identifier">cases</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Asm.Intrinsic.Structure.Internal.html#Asm"><span class="hs-identifier hs-var">C.Asm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679177244"><a href="#local-6989586621679177244"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-181"></a><span>    </span><a name="local-6989586621679177245"><a href="#local-6989586621679177245"><span class="hs-identifier">cf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.curFn</span><span> </span><a href="#local-6989586621679177244"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>    </span><span class="hs-identifier hs-var">forM</span><span> </span><a href="#local-6989586621679177243"><span class="hs-identifier hs-var">cases</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-183"></a><span>        </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCase"><span class="hs-identifier hs-var">ATCase</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679177246"><a href="#local-6989586621679177246"><span class="hs-identifier">cn</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679177247"><a href="#local-6989586621679177247"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679177248"><a href="#local-6989586621679177248"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679177249"><a href="#local-6989586621679177249"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-184"></a><span>            </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.lblCnt</span><span> </span><a href="#local-6989586621679177244"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">succ</span><span>
</span><a name="line-185"></a><span>            </span><a name="local-6989586621679177250"><a href="#local-6989586621679177250"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.lblCnt</span><span> </span><a href="#local-6989586621679177244"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>            </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;\tcmp rax, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><a href="#local-6989586621679177246"><span class="hs-identifier hs-var">cn</span></a><span>
</span><a name="line-187"></a><span>            </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;\tje .L.case.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177245"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><a href="#local-6989586621679177250"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-188"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCase"><span class="hs-identifier hs-var">ATCase</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679177250"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177246"><span class="hs-identifier hs-var">cn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177247"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679177248"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679177249"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-189"></a><span>        </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATDefault"><span class="hs-identifier hs-var">ATDefault</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679177251"><a href="#local-6989586621679177251"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679177252"><a href="#local-6989586621679177252"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679177253"><a href="#local-6989586621679177253"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-190"></a><span>            </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.lblCnt</span><span> </span><a href="#local-6989586621679177244"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">succ</span><span>
</span><a name="line-191"></a><span>            </span><a name="local-6989586621679177254"><a href="#local-6989586621679177254"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C.lblCnt</span><span> </span><a href="#local-6989586621679177244"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>            </span><span class="hs-identifier hs-var">T.putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;\tjmp .L.case.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679177245"><span class="hs-identifier hs-var">cf</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><a href="#local-6989586621679177254"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-193"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATDefault"><span class="hs-identifier hs-var">ATDefault</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679177254"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177251"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679177252"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679177253"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-194"></a><span>        </span><a name="local-6989586621679177255"><a href="#local-6989586621679177255"><span class="hs-identifier">at</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679177255"><span class="hs-identifier hs-var">at</span></a><span>
</span><a name="line-195"></a></pre></body></html>