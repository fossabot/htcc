<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, TupleSections, LambdaCase, BangPatterns, ScopedTypeVariables #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-|
Module      : Htcc.Parser.Parsing.Core
Description : The C languge parser and AST constructor
Copyright   : (c) roki, 2019
License     : MIT
Maintainer  : falgon53@yahoo.co.jp
Stability   : experimental
Portability : POSIX

The C languge parser and AST constructor
-}</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Htcc.Parser.Parsing.Core</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>    </span><span class="hs-comment">-- * Recursive descent implementation functions</span><span>
</span><a name="line-15"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#program"><span class="hs-identifier hs-var">program</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#globalDef"><span class="hs-identifier hs-var">globalDef</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#logicalOr"><span class="hs-identifier hs-var">logicalOr</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#logicalAnd"><span class="hs-identifier hs-var">logicalAnd</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#bitwiseOr"><span class="hs-identifier hs-var">bitwiseOr</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#bitwiseXor"><span class="hs-identifier hs-var">bitwiseXor</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#bitwiseAnd"><span class="hs-identifier hs-var">bitwiseAnd</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#shift"><span class="hs-identifier hs-var">shift</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#add"><span class="hs-identifier hs-var">add</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#term"><span class="hs-identifier hs-var">term</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#factor"><span class="hs-identifier hs-var">factor</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#relational"><span class="hs-identifier hs-var">relational</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#equality"><span class="hs-identifier hs-var">equality</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#conditional"><span class="hs-identifier hs-var">conditional</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#assign"><span class="hs-identifier hs-var">assign</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-comment">-- * Parser</span><span>
</span><a name="line-36"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#parse"><span class="hs-identifier hs-var">parse</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-comment">-- * Types and synonyms</span><span>
</span><a name="line-38"></a><span>    </span><a href="Htcc.Parser.AST.Type.html#ASTs"><span class="hs-identifier hs-type">ASTs</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>    </span><a href="Htcc.Parser.AST.Type.html#ASTSuccess"><span class="hs-identifier hs-type">ASTSuccess</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>    </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>    </span><a href="Htcc.Parser.AST.Type.html#ASTResult"><span class="hs-identifier hs-type">ASTResult</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-comment">-- * Utilities</span><span>
</span><a name="line-43"></a><span>    </span><a href="Htcc.Parser.Parsing.Core.html#stackSize"><span class="hs-identifier hs-var">stackSize</span></a><span>
</span><a name="line-44"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">shift</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Tuple.Extra</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">second</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">snd3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dupe</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">find</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isLeft</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">lefts</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">rights</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.STRef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">newSTRef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">forM</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.ST</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">runST</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Loops</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unfoldrM</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Numeric.Natural</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Utils.html"><span class="hs-identifier">Htcc.Utils</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-63"></a><span>    </span><a href="Htcc.Utils.Tuple.html#first3"><span class="hs-identifier hs-var">first3</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.Tuple.html#third3"><span class="hs-identifier hs-var">third3</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.Tuple.html#first4"><span class="hs-identifier hs-var">first4</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.Tuple.html#uncurry4"><span class="hs-identifier hs-var">uncurry4</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>    </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier hs-var">toNatural</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>    </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Utils.html#maybe%27"><span class="hs-identifier hs-var">maybe'</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Htcc.Tokenizer.html"><span class="hs-identifier">Htcc.Tokenizer</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HT</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Htcc.CRules.Types.html"><span class="hs-identifier">Htcc.CRules.Types</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CT</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Htcc.Parser.ConstructionData.Scope.Var.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.Var</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">PV</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.AST.html"><span class="hs-identifier">Htcc.Parser.AST</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Htcc.Parser.ConstructionData.Scope.Function.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.Function</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">PSF</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.ConstructionData.Scope.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.html#Scoped"><span class="hs-identifier hs-type">Scoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.ConstructionData.Scope.html#LookupVarResult"><span class="hs-identifier hs-type">LookupVarResult</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.Utils</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.ManagedScope</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.ConstructionData.html"><span class="hs-identifier">Htcc.Parser.ConstructionData</span></a><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.Utils.html"><span class="hs-identifier">Htcc.Parser.Utils</span></a><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.Parsing.Type.html"><span class="hs-identifier">Htcc.Parser.Parsing.Type</span></a><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.Parsing.Typedef.html"><span class="hs-identifier">Htcc.Parser.Parsing.Typedef</span></a><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.Parsing.StmtExpr.html"><span class="hs-identifier">Htcc.Parser.Parsing.StmtExpr</span></a><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Htcc.Parser.Parsing.Global.html"><span class="hs-identifier">Htcc.Parser.Parsing.Global</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">PGlobal</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">varDecl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-82"></a><span class="hs-identifier">varDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152226"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152226"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152226"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152226"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152226"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152226"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152226"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-83"></a><a name="varDecl"><a href="Htcc.Parser.Parsing.Core.html#varDecl"><span class="hs-identifier">varDecl</span></a></a><span> </span><a name="local-6989586621679152227"><a href="#local-6989586621679152227"><span class="hs-identifier">tk</span></a></a><span> </span><a name="local-6989586621679152228"><a href="#local-6989586621679152228"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Type.html#takeType"><span class="hs-identifier hs-var">takeType</span></a><span> </span><a href="#local-6989586621679152227"><span class="hs-identifier hs-var">tk</span></a><span> </span><a href="#local-6989586621679152228"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="#local-6989586621679152230"><span class="hs-identifier hs-var">validDecl</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Tokenizer.Token.html#altEmptyToken"><span class="hs-identifier hs-var">HT.altEmptyToken</span></a><span> </span><a href="#local-6989586621679152227"><span class="hs-identifier hs-var">tk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="#local-6989586621679152229"><span class="hs-identifier hs-var">varDecl'</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>        </span><a name="local-6989586621679152229"><a href="#local-6989586621679152229"><span class="hs-identifier">varDecl'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152231"><a href="#local-6989586621679152231"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152232"><a href="#local-6989586621679152232"><span class="hs-identifier">scp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152231"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152232"><span class="hs-identifier hs-var">scp'</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>        </span><span class="hs-identifier">varDecl'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152233"><a href="#local-6989586621679152233"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679152234"><a href="#local-6989586621679152234"><span class="hs-identifier">ident</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152235"><a href="#local-6989586621679152235"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152236"><a href="#local-6989586621679152236"><span class="hs-identifier">scp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;declaration with incomplete type&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152234"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><a href="#local-6989586621679152233"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152228"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152237"><a href="#local-6989586621679152237"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-87"></a><span>            </span><a href="Htcc.Parser.ConstructionData.Core.html#addLVar"><span class="hs-identifier hs-var">addLVar</span></a><span> </span><a href="#local-6989586621679152237"><span class="hs-identifier hs-var">t'</span></a><span> </span><a href="#local-6989586621679152234"><span class="hs-identifier hs-var">ident</span></a><span> </span><a href="#local-6989586621679152236"><span class="hs-identifier hs-var">scp'</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152238"><a href="#local-6989586621679152238"><span class="hs-identifier">lat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152239"><a href="#local-6989586621679152239"><span class="hs-identifier">scp''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152235"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atNull"><span class="hs-identifier hs-var">atNull</span></a><span> </span><a href="#local-6989586621679152238"><span class="hs-identifier hs-var">lat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152239"><span class="hs-identifier hs-var">scp''</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>        </span><span class="hs-identifier">varDecl'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152240"><a href="#local-6989586621679152240"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679152241"><a href="#local-6989586621679152241"><span class="hs-identifier">ident</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152242"><a href="#local-6989586621679152242"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152243"><a href="#local-6989586621679152243"><span class="hs-identifier">scp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Var.Init.html#varInit"><span class="hs-identifier hs-var">varInit</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#assign"><span class="hs-identifier hs-var">assign</span></a><span> </span><a href="#local-6989586621679152240"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152241"><span class="hs-identifier hs-var">ident</span></a><span> </span><a href="#local-6989586621679152242"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679152243"><span class="hs-identifier hs-var">scp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-89"></a><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152244"><a href="#local-6989586621679152244"><span class="hs-identifier">ds'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152245"><a href="#local-6989586621679152245"><span class="hs-identifier">at</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152246"><a href="#local-6989586621679152246"><span class="hs-identifier">sc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152244"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152245"><span class="hs-identifier hs-var">at</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152246"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token, the subject iteration statement starts here:&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152227"><span class="hs-identifier hs-var">tk</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>        </span><span class="hs-identifier">varDecl'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152247"><a href="#local-6989586621679152247"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152247"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected unqualified-id&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152227"><span class="hs-identifier hs-var">tk</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected unqualified-id before '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152247"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">T.singleton</span><span> </span><span class="hs-char">'\''</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152247"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>        </span><a name="local-6989586621679152230"><a href="#local-6989586621679152230"><span class="hs-identifier">validDecl</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152248"><a href="#local-6989586621679152248"><span class="hs-identifier">tnt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679152249"><a href="#local-6989586621679152249"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679152250"><a href="#local-6989586621679152250"><span class="hs-identifier">ident</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152251"><a href="#local-6989586621679152251"><span class="hs-identifier">scp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.html#maybe%27"><span class="hs-identifier hs-var">maybe'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679152248"><span class="hs-identifier hs-var">tnt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><a href="#local-6989586621679152249"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152251"><span class="hs-identifier hs-var">scp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152252"><a href="#local-6989586621679152252"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679152249"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTVoid"><span class="hs-identifier hs-var">CT.CTVoid</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-93"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;variable or field '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679152250"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' declarated void&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152250"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Tuple.html#first4"><span class="hs-identifier hs-var">first4</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679152252"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152248"><span class="hs-identifier hs-var">tnt</span></a><span>
</span><a name="line-94"></a><span>        </span><span class="hs-identifier">validDecl</span><span> </span><a name="local-6989586621679152253"><a href="#local-6989586621679152253"><span class="hs-identifier">errPlaceholder</span></a></a><span> </span><a name="local-6989586621679152254"><a href="#local-6989586621679152254"><span class="hs-identifier">tnt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679152255"><a href="#local-6989586621679152255"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152256"><a href="#local-6989586621679152256"><span class="hs-identifier">scp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.html#maybe%27"><span class="hs-identifier hs-var">maybe'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679152254"><span class="hs-identifier hs-var">tnt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><a href="#local-6989586621679152255"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152256"><span class="hs-identifier hs-var">scp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152257"><a href="#local-6989586621679152257"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679152255"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTVoid"><span class="hs-identifier hs-var">CT.CTVoid</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-95"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;declarations of type void is invalid in this context&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152253"><span class="hs-identifier hs-var">errPlaceholder</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Tuple.html#first4"><span class="hs-identifier hs-var">first4</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679152257"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152254"><span class="hs-identifier hs-var">tnt</span></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">-- | `program` indicates \(\eqref{eq:eigth}\) among the comments of `inners`.</span><span>
</span><a name="line-98"></a><span class="hs-identifier">program</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Type.html#ASTs"><span class="hs-identifier hs-type">ASTs</span></a><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152225"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><a name="program"><a href="Htcc.Parser.Parsing.Core.html#program"><span class="hs-identifier">program</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152258"><a href="#local-6989586621679152258"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152258"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span class="hs-identifier">program</span><span> </span><a name="local-6989586621679152259"><a href="#local-6989586621679152259"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152260"><a href="#local-6989586621679152260"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152261"><a href="#local-6989586621679152261"><span class="hs-identifier">ys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152262"><a href="#local-6989586621679152262"><span class="hs-identifier">atn</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152263"><a href="#local-6989586621679152263"><span class="hs-identifier">scp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">first</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152262"><span class="hs-identifier hs-var">atn</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#program"><span class="hs-identifier hs-var">program</span></a><span> </span><a href="#local-6989586621679152261"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152263"><span class="hs-identifier hs-var">scp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#globalDef"><span class="hs-identifier hs-var">globalDef</span></a><span> </span><a href="#local-6989586621679152259"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><a href="#local-6989586621679152260"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- | `globalDef` parses global definitions (include functions and global variables)</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- \[</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- \text{global-def}=\left(\text{global-var}\ \mid\ \text{function}\right)\text{*}</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- \]</span><span>
</span><a name="line-106"></a><span class="hs-identifier">globalDef</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152224"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-107"></a><a name="globalDef"><a href="Htcc.Parser.Parsing.Core.html#globalDef"><span class="hs-identifier">globalDef</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152264"><a href="#local-6989586621679152264"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;register&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;illegal storage class on file-scoped identifier&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152264"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span class="hs-identifier">globalDef</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152265"><a href="#local-6989586621679152265"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;auto&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;illegal storage class on file-scoped identifier&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152265"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-identifier">globalDef</span><span> </span><a name="local-6989586621679152266"><a href="#local-6989586621679152266"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKTypedef"><span class="hs-identifier hs-var">HT.TKTypedef</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152267"><a href="#local-6989586621679152267"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Typedef.html#typedef"><span class="hs-identifier hs-var">typedef</span></a><span> </span><a href="#local-6989586621679152266"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152267"><span class="hs-identifier hs-var">sc</span></a><span> </span><span class="hs-comment">-- for global @typedef@</span><span>
</span><a name="line-110"></a><span class="hs-identifier">globalDef</span><span> </span><a name="local-6989586621679152268"><a href="#local-6989586621679152268"><span class="hs-identifier">tks</span></a></a><span> </span><a name="local-6989586621679152269"><a href="#local-6989586621679152269"><span class="hs-identifier">at</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152270"><a href="#local-6989586621679152270"><span class="hs-identifier">va</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Type.html#takeType"><span class="hs-identifier hs-var">takeType</span></a><span> </span><a href="#local-6989586621679152268"><span class="hs-identifier hs-var">tks</span></a><span> </span><a href="#local-6989586621679152270"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152271"><a href="#local-6989586621679152271"><span class="hs-identifier">ds'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152272"><a href="#local-6989586621679152272"><span class="hs-identifier">scp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152271"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152272"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- e.g., @int;@ is legal in C11 (See N1570/section 6.7 Declarations)</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679152273"><a href="#local-6989586621679152273"><span class="hs-identifier">funcType</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152274"><a href="#local-6989586621679152274"><span class="hs-identifier">ident</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152275"><a href="#local-6989586621679152275"><span class="hs-identifier">tk</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152276"><a href="#local-6989586621679152276"><span class="hs-identifier">sc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Global.Function.html#function"><span class="hs-identifier hs-var">PGlobal.function</span></a><span> </span><a href="#local-6989586621679152273"><span class="hs-identifier hs-var">funcType</span></a><span> </span><a href="#local-6989586621679152274"><span class="hs-identifier hs-var">ident</span></a><span> </span><a href="#local-6989586621679152275"><span class="hs-identifier hs-var">tk</span></a><span> </span><a href="#local-6989586621679152269"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152276"><span class="hs-identifier hs-var">sc</span></a><span>
</span><a name="line-113"></a><span>    </span><a name="local-6989586621679152277"><a href="#local-6989586621679152277"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#uncurry4"><span class="hs-identifier hs-var">uncurry4</span></a><span> </span><a href="Htcc.Parser.Parsing.Global.Var.html#var"><span class="hs-identifier hs-var">PGlobal.var</span></a><span> </span><a href="#local-6989586621679152277"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid definition of global identifier&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#altEmptyToken"><span class="hs-identifier hs-var">HT.altEmptyToken</span></a><span> </span><a href="#local-6989586621679152268"><span class="hs-identifier hs-var">tks</span></a><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | `stmt` indicates \(\eqref{eq:nineth}\) among the comments of `inners`.</span><span>
</span><a name="line-117"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152223"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-118"></a><a name="stmt"><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier">stmt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReturn"><span class="hs-identifier hs-var">HT.TKReturn</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152278"><a href="#local-6989586621679152278"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152279"><a href="#local-6989586621679152279"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152278"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atReturn"><span class="hs-identifier hs-var">atReturn</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCUndef"><span class="hs-identifier hs-var">CT.SCUndef</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTUndef"><span class="hs-identifier hs-var">CT.CTUndef</span></a><span class="hs-special">)</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152279"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for @return;@</span><span>
</span><a name="line-119"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152280"><a href="#local-6989586621679152280"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReturn"><span class="hs-identifier hs-var">HT.TKReturn</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152281"><a href="#local-6989586621679152281"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152282"><a href="#local-6989586621679152282"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152283"><a href="#local-6989586621679152283"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152281"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152282"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152283"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152284"><a href="#local-6989586621679152284"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152285"><a href="#local-6989586621679152285"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152286"><a href="#local-6989586621679152286"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152284"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for @return@</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152287"><a href="#local-6989586621679152287"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152287"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atReturn"><span class="hs-identifier hs-var">atReturn</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCUndef"><span class="hs-identifier hs-var">CT.SCUndef</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTUndef"><span class="hs-identifier hs-var">CT.CTUndef</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152285"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152286"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>    </span><a name="local-6989586621679152288"><a href="#local-6989586621679152288"><span class="hs-identifier">ert'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Utils.Core.html#expectedMessage"><span class="hs-identifier hs-var">expectedMessage</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span> </span><a href="#local-6989586621679152280"><span class="hs-identifier hs-var">cur</span></a><span> </span><a href="#local-6989586621679152288"><span class="hs-identifier hs-var">ert'</span></a><span>
</span><a name="line-122"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152289"><a href="#local-6989586621679152289"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIf"><span class="hs-identifier hs-var">HT.TKIf</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152290"><a href="#local-6989586621679152290"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152291"><a href="#local-6989586621679152291"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152292"><a href="#local-6989586621679152292"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152290"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152291"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152292"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152293"><a href="#local-6989586621679152293"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152294"><a href="#local-6989586621679152294"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152295"><a href="#local-6989586621679152295"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152293"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for @if@</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152296"><a href="#local-6989586621679152296"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152296"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152294"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152295"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152297"><a href="#local-6989586621679152297"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atIf"><span class="hs-identifier hs-var">atIf</span></a><span> </span><a href="#local-6989586621679152294"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152297"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-124"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKElse"><span class="hs-identifier hs-var">HT.TKElse</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152298"><a href="#local-6989586621679152298"><span class="hs-identifier">zs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152299"><a href="#local-6989586621679152299"><span class="hs-identifier">eerat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152300"><a href="#local-6989586621679152300"><span class="hs-identifier">eerscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atElse"><span class="hs-identifier hs-var">atElse</span></a><span> </span><a href="#local-6989586621679152299"><span class="hs-identifier hs-var">eerat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152298"><span class="hs-identifier hs-var">zs</span></a><span> </span><a href="#local-6989586621679152299"><span class="hs-identifier hs-var">eerat</span></a><span> </span><a href="#local-6989586621679152300"><span class="hs-identifier hs-var">eerscp</span></a><span> </span><span class="hs-comment">-- for @else@</span><span>
</span><a name="line-125"></a><span>        </span><a name="local-6989586621679152301"><a href="#local-6989586621679152301"><span class="hs-identifier">zs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679152301"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-126"></a><span>    </span><a name="local-6989586621679152302"><a href="#local-6989586621679152302"><span class="hs-identifier">ert'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Utils.Core.html#expectedMessage"><span class="hs-identifier hs-var">expectedMessage</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span> </span><a href="#local-6989586621679152289"><span class="hs-identifier hs-var">cur</span></a><span> </span><a href="#local-6989586621679152302"><span class="hs-identifier hs-var">ert'</span></a><span>
</span><a name="line-127"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152303"><a href="#local-6989586621679152303"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKWhile"><span class="hs-identifier hs-var">HT.TKWhile</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152304"><a href="#local-6989586621679152304"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152305"><a href="#local-6989586621679152305"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152306"><a href="#local-6989586621679152306"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152304"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152305"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152306"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152307"><a href="#local-6989586621679152307"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152308"><a href="#local-6989586621679152308"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152309"><a href="#local-6989586621679152309"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152307"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for @while@</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152310"><a href="#local-6989586621679152310"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atWhile"><span class="hs-identifier hs-var">atWhile</span></a><span> </span><a href="#local-6989586621679152308"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152310"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152308"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152309"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-129"></a><span>    </span><a name="local-6989586621679152311"><a href="#local-6989586621679152311"><span class="hs-identifier">ert'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Utils.Core.html#expectedMessage"><span class="hs-identifier hs-var">expectedMessage</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span> </span><a href="#local-6989586621679152303"><span class="hs-identifier hs-var">cur</span></a><span> </span><a href="#local-6989586621679152311"><span class="hs-identifier hs-var">ert'</span></a><span>
</span><a name="line-130"></a><span class="hs-identifier">stmt</span><span> </span><a name="local-6989586621679152312"><a href="#local-6989586621679152312"><span class="hs-identifier">xxs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679152313"><a href="#local-6989586621679152313"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKFor"><span class="hs-identifier hs-var">HT.TKFor</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152314"><a href="#local-6989586621679152314"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152313"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Utils.Core.html#takeBrace"><span class="hs-identifier hs-var">takeBrace</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679152312"><span class="hs-identifier hs-var">xxs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-comment">-- for @for@</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ')' token. The subject iteration statement starts here:&quot;</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152337"><a href="#local-6989586621679152337"><span class="hs-identifier">forSt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152338"><a href="#local-6989586621679152338"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152315"><span class="hs-identifier hs-var">initSect</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span> </span><a href="#local-6989586621679152337"><span class="hs-identifier hs-var">forSt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#succNest"><span class="hs-identifier hs-var">succNest</span></a><span> </span><a href="#local-6989586621679152314"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152339"><a href="#local-6989586621679152339"><span class="hs-identifier">fxs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152340"><a href="#local-6989586621679152340"><span class="hs-identifier">finit</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152341"><a href="#local-6989586621679152341"><span class="hs-identifier">fscp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-132"></a><span>        </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152316"><span class="hs-identifier hs-var">condSect</span></a><span> </span><a href="#local-6989586621679152339"><span class="hs-identifier hs-var">fxs</span></a><span> </span><a href="#local-6989586621679152341"><span class="hs-identifier hs-var">fscp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152342"><a href="#local-6989586621679152342"><span class="hs-identifier">fxs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152343"><a href="#local-6989586621679152343"><span class="hs-identifier">fcond</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152344"><a href="#local-6989586621679152344"><span class="hs-identifier">fscp''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152317"><span class="hs-identifier hs-var">incrSect</span></a><span> </span><a href="#local-6989586621679152342"><span class="hs-identifier hs-var">fxs'</span></a><span> </span><a href="#local-6989586621679152344"><span class="hs-identifier hs-var">fscp''</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-133"></a><span>            </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152345"><a href="#local-6989586621679152345"><span class="hs-identifier">fincr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152346"><a href="#local-6989586621679152346"><span class="hs-identifier">fscp'''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-134"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152347"><a href="#local-6989586621679152347"><span class="hs-identifier">fnd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152349"><a href="#local-6989586621679152349"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Htcc.Parser.AST.Core.html#fromATKindFor"><span class="hs-identifier hs-var">fromATKindFor</span></a><span> </span><a href="#local-6989586621679152349"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><a name="local-6989586621679152350"><a href="#local-6989586621679152350"><span class="hs-identifier">x''</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.AST.Core.html#isEmptyExprStmt"><span class="hs-identifier hs-var">isEmptyExprStmt</span></a><span> </span><a href="#local-6989586621679152350"><span class="hs-identifier hs-var">x''</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Parser.AST.Core.html#ATForInit"><span class="hs-identifier hs-var">ATForInit</span></a><span> </span><a href="#local-6989586621679152340"><span class="hs-identifier hs-var">finit</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATForCond"><span class="hs-identifier hs-var">ATForCond</span></a><span> </span><a href="#local-6989586621679152343"><span class="hs-identifier hs-var">fcond</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATForIncr"><span class="hs-identifier hs-var">ATForIncr</span></a><span> </span><a href="#local-6989586621679152345"><span class="hs-identifier hs-var">fincr</span></a><span class="hs-special">]</span><span>
</span><a name="line-135"></a><span>                    </span><a name="local-6989586621679152348"><a href="#local-6989586621679152348"><span class="hs-identifier">mkk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATForCond"><span class="hs-identifier hs-var">ATForCond</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atNumLit"><span class="hs-identifier hs-var">atNumLit</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152347"><span class="hs-identifier hs-var">fnd</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679152347"><span class="hs-identifier hs-var">fnd</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><a href="Htcc.Parser.AST.Core.html#isATForCond"><span class="hs-identifier hs-var">isATForCond</span></a><span> </span><a href="#local-6989586621679152347"><span class="hs-identifier hs-var">fnd</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152338"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-136"></a><span>                        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152351"><a href="#local-6989586621679152351"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152351"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atFor"><span class="hs-identifier hs-var">atFor</span></a><span> </span><a href="#local-6989586621679152348"><span class="hs-identifier hs-var">mkk</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#fallBack"><span class="hs-identifier hs-var">fallBack</span></a><span> </span><a href="#local-6989586621679152314"><span class="hs-identifier hs-var">scp</span></a><span> </span><a href="#local-6989586621679152346"><span class="hs-identifier hs-var">fscp'''</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#third3"><span class="hs-identifier hs-var">third3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#fallBack"><span class="hs-identifier hs-var">fallBack</span></a><span> </span><a href="#local-6989586621679152314"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atFor"><span class="hs-identifier hs-var">atFor</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152348"><span class="hs-identifier hs-var">mkk</span></a><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATForStmt"><span class="hs-identifier hs-var">ATForStmt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152338"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><a href="#local-6989586621679152346"><span class="hs-identifier hs-var">fscp'''</span></a><span>
</span><a name="line-138"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;unexpected end of for statement&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152313"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-140"></a><span>        </span><a name="local-6989586621679152315"><a href="#local-6989586621679152315"><span class="hs-identifier">initSect</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;the iteration statement for must be `for (expression_opt; expression_opt; expression_opt) statement`. See section 6.8.5.&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152313"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>        </span><span class="hs-identifier">initSect</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152318"><a href="#local-6989586621679152318"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152319"><a href="#local-6989586621679152319"><span class="hs-identifier">fsc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152318"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152319"><span class="hs-identifier hs-var">fsc</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>        </span><span class="hs-identifier">initSect</span><span> </span><a name="local-6989586621679152320"><a href="#local-6989586621679152320"><span class="hs-identifier">forSect</span></a></a><span> </span><a name="local-6989586621679152321"><a href="#local-6989586621679152321"><span class="hs-identifier">fsc</span></a></a><span>
</span><a name="line-143"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152320"><span class="hs-identifier hs-var">forSect</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152321"><span class="hs-identifier hs-var">fsc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#varDecl"><span class="hs-identifier hs-var">varDecl</span></a><span> </span><a href="#local-6989586621679152320"><span class="hs-identifier hs-var">forSect</span></a><span> </span><a href="#local-6989586621679152321"><span class="hs-identifier hs-var">fsc</span></a><span>
</span><a name="line-144"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152320"><span class="hs-identifier hs-var">forSect</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><a href="#local-6989586621679152321"><span class="hs-identifier hs-var">fsc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152322"><a href="#local-6989586621679152322"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152323"><a href="#local-6989586621679152323"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152324"><a href="#local-6989586621679152324"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152322"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-145"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152325"><a href="#local-6989586621679152325"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152325"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atExprStmt"><span class="hs-identifier hs-var">atExprStmt</span></a><span> </span><a href="#local-6989586621679152323"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152324"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152322"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token after '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152322"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152322"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>        </span><a name="local-6989586621679152316"><a href="#local-6989586621679152316"><span class="hs-identifier">condSect</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;the iteration statement for must be `for (expression_opt; expression_opt; expression_opt) statement`. See section 6.8.5.&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152313"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>        </span><span class="hs-identifier">condSect</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152326"><a href="#local-6989586621679152326"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152327"><a href="#local-6989586621679152327"><span class="hs-identifier">fsc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152326"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152327"><span class="hs-identifier hs-var">fsc</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>        </span><span class="hs-identifier">condSect</span><span> </span><a name="local-6989586621679152328"><a href="#local-6989586621679152328"><span class="hs-identifier">forSect</span></a></a><span> </span><a name="local-6989586621679152329"><a href="#local-6989586621679152329"><span class="hs-identifier">fsc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152328"><span class="hs-identifier hs-var">forSect</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><a href="#local-6989586621679152329"><span class="hs-identifier hs-var">fsc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-150"></a><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152330"><a href="#local-6989586621679152330"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152331"><a href="#local-6989586621679152331"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152332"><a href="#local-6989586621679152332"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152330"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152331"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152332"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679152333"><a href="#local-6989586621679152333"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152333"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token after '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152333"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152333"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>        </span><a name="local-6989586621679152317"><a href="#local-6989586621679152317"><span class="hs-identifier">incrSect</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679152334"><a href="#local-6989586621679152334"><span class="hs-identifier">fsc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152334"><span class="hs-identifier hs-var">fsc</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>        </span><span class="hs-identifier">incrSect</span><span> </span><a name="local-6989586621679152335"><a href="#local-6989586621679152335"><span class="hs-identifier">forSect</span></a></a><span> </span><a name="local-6989586621679152336"><a href="#local-6989586621679152336"><span class="hs-identifier">fsc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#atExprStmt"><span class="hs-identifier hs-var">atExprStmt</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152335"><span class="hs-identifier hs-var">forSect</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><a href="#local-6989586621679152336"><span class="hs-identifier hs-var">fsc</span></a><span>
</span><a name="line-154"></a><span class="hs-identifier">stmt</span><span> </span><a name="local-6989586621679152352"><a href="#local-6989586621679152352"><span class="hs-identifier">xxs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679152353"><a href="#local-6989586621679152353"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;{&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152354"><a href="#local-6989586621679152354"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152353"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Utils.Core.html#takeBrace"><span class="hs-identifier hs-var">takeBrace</span></a><span> </span><span class="hs-string">&quot;{&quot;</span><span> </span><span class="hs-string">&quot;}&quot;</span><span> </span><a href="#local-6989586621679152352"><span class="hs-identifier hs-var">xxs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-comment">-- for compound statement</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;the compound statement is not closed&quot;</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152355"><a href="#local-6989586621679152355"><span class="hs-identifier">sctk</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152356"><a href="#local-6989586621679152356"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-156"></a><span>        </span><a name="local-6989586621679152357"><a href="#local-6989586621679152357"><span class="hs-identifier">eri</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-157"></a><span>        </span><a name="local-6989586621679152358"><a href="#local-6989586621679152358"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#succNest"><span class="hs-identifier hs-var">succNest</span></a><span> </span><a href="#local-6989586621679152354"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-158"></a><span>        </span><a name="local-6989586621679152365"><a href="#local-6989586621679152365"><span class="hs-identifier">mk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">unfoldrM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679152355"><span class="hs-identifier hs-var">sctk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152359"><a href="#local-6989586621679152359"><span class="hs-identifier">ert</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152359"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-159"></a><span>            </span><a name="local-6989586621679152360"><a href="#local-6989586621679152360"><span class="hs-identifier">erscp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679152358"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-160"></a><span>            </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152361"><a href="#local-6989586621679152361"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-operator hs-var">&lt;$</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679152357"><span class="hs-identifier hs-var">eri</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679152361"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152362"><a href="#local-6989586621679152362"><span class="hs-identifier">ert'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152363"><a href="#local-6989586621679152363"><span class="hs-identifier">erat'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152364"><a href="#local-6989586621679152364"><span class="hs-identifier">erscp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152363"><span class="hs-identifier hs-var">erat'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152362"><span class="hs-identifier hs-var">ert'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679152358"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679152364"><span class="hs-identifier hs-var">erscp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152359"><span class="hs-identifier hs-var">ert</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><a href="#local-6989586621679152360"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-161"></a><span>        </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679152357"><span class="hs-identifier hs-var">eri</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Left</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152356"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atBlock"><span class="hs-identifier hs-var">atBlock</span></a><span> </span><a href="#local-6989586621679152365"><span class="hs-identifier hs-var">mk</span></a><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#fallBack"><span class="hs-identifier hs-var">fallBack</span></a><span> </span><a href="#local-6989586621679152354"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679152358"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-162"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152366"><a href="#local-6989586621679152366"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152367"><a href="#local-6989586621679152367"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152368"><a href="#local-6989586621679152368"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152366"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152367"><span class="hs-identifier hs-var">atn</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152368"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for only @;@</span><span>
</span><a name="line-163"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152369"><a href="#local-6989586621679152369"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKBreak"><span class="hs-identifier hs-var">HT.TKBreak</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152370"><a href="#local-6989586621679152370"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152371"><a href="#local-6989586621679152371"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152370"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for @break@</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152372"><a href="#local-6989586621679152372"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152372"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atBreak"><span class="hs-identifier hs-var">atBreak</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152371"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token after 'break' token&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152369"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152373"><a href="#local-6989586621679152373"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKContinue"><span class="hs-identifier hs-var">HT.TKContinue</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152374"><a href="#local-6989586621679152374"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152375"><a href="#local-6989586621679152375"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152374"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for @continue@</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152376"><a href="#local-6989586621679152376"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152376"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atContinue"><span class="hs-identifier hs-var">atContinue</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152375"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token after 'continue' token&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152373"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152377"><a href="#local-6989586621679152377"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKSwitch"><span class="hs-identifier hs-var">HT.TKSwitch</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152378"><a href="#local-6989586621679152378"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152379"><a href="#local-6989586621679152379"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152380"><a href="#local-6989586621679152380"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152378"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for @switch@</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152381"><a href="#local-6989586621679152381"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152381"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621679152379"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152380"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-171"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679152382"><a href="#local-6989586621679152382"><span class="hs-identifier">cur1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152383"><a href="#local-6989586621679152383"><span class="hs-identifier">xs''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152384"><a href="#local-6989586621679152384"><span class="hs-identifier">cond</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152385"><a href="#local-6989586621679152385"><span class="hs-identifier">scp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-172"></a><span>            </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152383"><span class="hs-identifier hs-var">xs''</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152385"><span class="hs-identifier hs-var">scp'</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">isSwitchStmt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-173"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679152386"><a href="#local-6989586621679152386"><span class="hs-identifier">xs'''</span></a></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATBlock"><span class="hs-identifier hs-var">ATBlock</span></a><span> </span><a name="local-6989586621679152387"><a href="#local-6989586621679152387"><span class="hs-identifier">ats</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152388"><a href="#local-6989586621679152388"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152389"><a href="#local-6989586621679152389"><span class="hs-identifier">scp''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152386"><span class="hs-identifier hs-var">xs'''</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atSwitch"><span class="hs-identifier hs-var">atSwitch</span></a><span> </span><a href="#local-6989586621679152384"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679152387"><span class="hs-identifier hs-var">ats</span></a><span> </span><a href="#local-6989586621679152388"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152389"><span class="hs-identifier hs-var">scp''</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">isSwitchStmt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected compound statement after the token ')'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152382"><span class="hs-identifier hs-var">cur1</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679152390"><a href="#local-6989586621679152390"><span class="hs-identifier">xs''</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152390"><span class="hs-identifier hs-var">xs''</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected token ')' before '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152381"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' token&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152381"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ')' token&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected token '(' after the token 'switch'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152377"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152391"><a href="#local-6989586621679152391"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKCase"><span class="hs-identifier hs-var">HT.TKCase</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152392"><a href="#local-6989586621679152392"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152393"><a href="#local-6989586621679152393"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152394"><a href="#local-6989586621679152394"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-comment">-- for @case@</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isSwitchStmt</span><span> </span><a href="#local-6989586621679152394"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected constant expression after 'case' token&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152391"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Type.html#constantExp"><span class="hs-identifier hs-var">constantExp</span></a><span> </span><a href="#local-6989586621679152392"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152394"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-179"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152395"><a href="#local-6989586621679152395"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152396"><a href="#local-6989586621679152396"><span class="hs-identifier">val</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atCase"><span class="hs-identifier hs-var">atCase</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679152396"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152395"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679152393"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152394"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-180"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679152397"><a href="#local-6989586621679152397"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152397"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ':' token before '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span>  </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152397"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152397"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ':' token&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152397"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;stray 'case'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152391"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152398"><a href="#local-6989586621679152398"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKDefault"><span class="hs-identifier hs-var">HT.TKDefault</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152399"><a href="#local-6989586621679152399"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152400"><a href="#local-6989586621679152400"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152401"><a href="#local-6989586621679152401"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-comment">-- for @default@</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isSwitchStmt</span><span> </span><a href="#local-6989586621679152401"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atDefault"><span class="hs-identifier hs-var">atDefault</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#stmt"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679152399"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152400"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152401"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-184"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;stray 'default'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152398"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152402"><a href="#local-6989586621679152402"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKGoto"><span class="hs-identifier hs-var">HT.TKGoto</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152403"><a href="#local-6989586621679152403"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152404"><a href="#local-6989586621679152404"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152403"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for @goto@</span><span>
</span><a name="line-186"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152405"><a href="#local-6989586621679152405"><span class="hs-identifier">ident</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152406"><a href="#local-6989586621679152406"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152406"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atGoto"><span class="hs-identifier hs-var">atGoto</span></a><span> </span><a href="#local-6989586621679152405"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152404"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152407"><a href="#local-6989586621679152407"><span class="hs-identifier">ident</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ';' token after the identifier '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679152407"><span class="hs-identifier hs-var">ident</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152402"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected identifier after the 'goto' token&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152402"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span class="hs-identifier">stmt</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152408"><a href="#local-6989586621679152408"><span class="hs-identifier">ident</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152409"><a href="#local-6989586621679152409"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152410"><a href="#local-6989586621679152410"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152409"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atLabel"><span class="hs-identifier hs-var">atLabel</span></a><span> </span><a href="#local-6989586621679152408"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152410"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for local label</span><span>
</span><a name="line-190"></a><span class="hs-identifier">stmt</span><span> </span><a name="local-6989586621679152411"><a href="#local-6989586621679152411"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKTypedef"><span class="hs-identifier hs-var">HT.TKTypedef</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152412"><a href="#local-6989586621679152412"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Typedef.html#typedef"><span class="hs-identifier hs-var">typedef</span></a><span> </span><a href="#local-6989586621679152411"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152412"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-comment">-- for local @typedef@</span><span>
</span><a name="line-191"></a><span class="hs-identifier">stmt</span><span> </span><a name="local-6989586621679152413"><a href="#local-6989586621679152413"><span class="hs-identifier">tk</span></a></a><span> </span><a name="local-6989586621679152414"><a href="#local-6989586621679152414"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152415"><a href="#local-6989586621679152415"><span class="hs-identifier">scp</span></a></a><span>
</span><a name="line-192"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152413"><span class="hs-identifier hs-var">tk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152413"><span class="hs-identifier hs-var">tk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152415"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#varDecl"><span class="hs-identifier hs-var">varDecl</span></a><span> </span><a href="#local-6989586621679152413"><span class="hs-identifier hs-var">tk</span></a><span> </span><a href="#local-6989586621679152415"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-comment">-- for a local variable declaration</span><span>
</span><a name="line-193"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152413"><span class="hs-identifier hs-var">tk</span></a><span> </span><a href="#local-6989586621679152414"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152415"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152416"><a href="#local-6989586621679152416"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152417"><a href="#local-6989586621679152417"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152418"><a href="#local-6989586621679152418"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152416"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for stmt;</span><span>
</span><a name="line-194"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152419"><a href="#local-6989586621679152419"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152419"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atExprStmt"><span class="hs-identifier hs-var">atExprStmt</span></a><span> </span><a href="#local-6989586621679152417"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152418"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>        </span><a name="local-6989586621679152420"><a href="#local-6989586621679152420"><span class="hs-identifier">ert'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Utils.Core.html#expectedMessage"><span class="hs-identifier hs-var">expectedMessage</span></a><span> </span><span class="hs-string">&quot;;&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152413"><span class="hs-identifier hs-var">tk</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679152413"><span class="hs-identifier hs-var">tk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152420"><span class="hs-identifier hs-var">ert'</span></a><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">expr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- | \({\rm expr} = {\rm assign}\left(&quot;,&quot; {\rm assign}\right)\ast\)</span><span>
</span><a name="line-199"></a><span class="hs-identifier">expr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152222"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-200"></a><a name="expr"><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679152421"><a href="#local-6989586621679152421"><span class="hs-identifier">tk</span></a></a><span> </span><a name="local-6989586621679152422"><a href="#local-6989586621679152422"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152423"><a href="#local-6989586621679152423"><span class="hs-identifier">cd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#assign"><span class="hs-identifier hs-var">assign</span></a><span> </span><a href="#local-6989586621679152421"><span class="hs-identifier hs-var">tk</span></a><span> </span><a href="#local-6989586621679152422"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152423"><span class="hs-identifier hs-var">cd</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">uncurry3</span><span> </span><a href="#local-6989586621679152424"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-201"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-202"></a><span>        </span><a name="local-6989586621679152424"><a href="#local-6989586621679152424"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152425"><a href="#local-6989586621679152425"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152426"><a href="#local-6989586621679152426"><span class="hs-identifier">at'</span></a></a><span> </span><a name="local-6989586621679152427"><a href="#local-6989586621679152427"><span class="hs-identifier">cd'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#assign"><span class="hs-identifier hs-var">assign</span></a><span> </span><a href="#local-6989586621679152425"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152426"><span class="hs-identifier hs-var">at'</span></a><span> </span><a href="#local-6989586621679152427"><span class="hs-identifier hs-var">cd'</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">uncurry3</span><span> </span><a href="#local-6989586621679152424"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152428"><a href="#local-6989586621679152428"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#atComma"><span class="hs-identifier hs-var">atComma</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152428"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atExprStmt"><span class="hs-identifier hs-var">atExprStmt</span></a><span> </span><a href="#local-6989586621679152426"><span class="hs-identifier hs-var">at'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152428"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679152429"><a href="#local-6989586621679152429"><span class="hs-identifier">tk'</span></a></a><span> </span><a name="local-6989586621679152430"><a href="#local-6989586621679152430"><span class="hs-identifier">at'</span></a></a><span> </span><a name="local-6989586621679152431"><a href="#local-6989586621679152431"><span class="hs-identifier">cd'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152429"><span class="hs-identifier hs-var">tk'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152430"><span class="hs-identifier hs-var">at'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152431"><span class="hs-identifier hs-var">cd'</span></a><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">-- | `assign` indicates \(\eqref{eq:seventh}\) among the comments of `inners`.</span><span>
</span><a name="line-206"></a><span class="hs-identifier">assign</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152221"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-207"></a><a name="assign"><a href="Htcc.Parser.Parsing.Core.html#assign"><span class="hs-identifier">assign</span></a></a><span> </span><a name="local-6989586621679152432"><a href="#local-6989586621679152432"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679152433"><a href="#local-6989586621679152433"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152434"><a href="#local-6989586621679152434"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#conditional"><span class="hs-identifier hs-var">conditional</span></a><span> </span><a href="#local-6989586621679152432"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152433"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152434"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152444"><a href="#local-6989586621679152444"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152445"><a href="#local-6989586621679152445"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152446"><a href="#local-6989586621679152446"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152444"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152447"><a href="#local-6989586621679152447"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAssign"><span class="hs-identifier hs-var">ATAssign</span></a><span> </span><a href="#local-6989586621679152447"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-209"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;*=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152448"><a href="#local-6989586621679152448"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATMulAssign"><span class="hs-identifier hs-var">ATMulAssign</span></a><span> </span><a href="#local-6989586621679152448"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-210"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;/=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152449"><a href="#local-6989586621679152449"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATDivAssign"><span class="hs-identifier hs-var">ATDivAssign</span></a><span> </span><a href="#local-6989586621679152449"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-211"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;&amp;=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152450"><a href="#local-6989586621679152450"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAndAssign"><span class="hs-identifier hs-var">ATAndAssign</span></a><span> </span><a href="#local-6989586621679152450"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-212"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;|=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152451"><a href="#local-6989586621679152451"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATOrAssign"><span class="hs-identifier hs-var">ATOrAssign</span></a><span> </span><a href="#local-6989586621679152451"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-213"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;^=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152452"><a href="#local-6989586621679152452"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATXorAssign"><span class="hs-identifier hs-var">ATXorAssign</span></a><span> </span><a href="#local-6989586621679152452"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;&lt;&lt;=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152453"><a href="#local-6989586621679152453"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATShlAssign"><span class="hs-identifier hs-var">ATShlAssign</span></a><span> </span><a href="#local-6989586621679152453"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-215"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;&gt;&gt;=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152454"><a href="#local-6989586621679152454"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATShrAssign"><span class="hs-identifier hs-var">ATShrAssign</span></a><span> </span><a href="#local-6989586621679152454"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-216"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;+=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152455"><a href="#local-6989586621679152455"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATAddAssign"><span class="hs-identifier hs-var">ATAddAssign</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATAddPtrAssign"><span class="hs-identifier hs-var">ATAddPtrAssign</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152455"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-217"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;-=&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152456"><a href="#local-6989586621679152456"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-var">nextNode</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATSubAssign"><span class="hs-identifier hs-var">ATSubAssign</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATSubPtrAssign"><span class="hs-identifier hs-var">ATSubPtrAssign</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152456"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-218"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152444"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>        </span><a name="local-6989586621679152435"><a href="#local-6989586621679152435"><span class="hs-identifier">nextNode</span></a></a><span> </span><a name="local-6989586621679152436"><a href="#local-6989586621679152436"><span class="hs-identifier">atk</span></a></a><span> </span><a name="local-6989586621679152437"><a href="#local-6989586621679152437"><span class="hs-identifier">ys</span></a></a><span> </span><a name="local-6989586621679152438"><a href="#local-6989586621679152438"><span class="hs-identifier">erat</span></a></a><span> </span><a name="local-6989586621679152439"><a href="#local-6989586621679152439"><span class="hs-identifier">erscp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#assign"><span class="hs-identifier hs-var">assign</span></a><span> </span><a href="#local-6989586621679152437"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152438"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152439"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152440"><a href="#local-6989586621679152440"><span class="hs-identifier">zs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152441"><a href="#local-6989586621679152441"><span class="hs-identifier">erat'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152442"><a href="#local-6989586621679152442"><span class="hs-identifier">erscp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-221"></a><span>            </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Var.Init.html#validAssign"><span class="hs-identifier hs-var">validAssign</span></a><span>  </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152440"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152440"><span class="hs-identifier hs-var">zs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152437"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152437"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152432"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152432"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152441"><span class="hs-identifier hs-var">erat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152443"><a href="#local-6989586621679152443"><span class="hs-identifier">erat''</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-222"></a><span>                </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152440"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="#local-6989586621679152436"><span class="hs-identifier hs-var">atk</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152438"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152438"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152443"><span class="hs-identifier hs-var">erat''</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152442"><span class="hs-identifier hs-var">erscp'</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-comment">-- | `conditional` indicates \(\eqref{eq:seventeenth}\) among the comments of `inners`.</span><span>
</span><a name="line-225"></a><span class="hs-identifier">conditional</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152220"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-226"></a><a name="conditional"><a href="Htcc.Parser.Parsing.Core.html#conditional"><span class="hs-identifier">conditional</span></a></a><span> </span><a name="local-6989586621679152457"><a href="#local-6989586621679152457"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679152458"><a href="#local-6989586621679152458"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152459"><a href="#local-6989586621679152459"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#logicalOr"><span class="hs-identifier hs-var">logicalOr</span></a><span> </span><a href="#local-6989586621679152457"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152458"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152459"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152460"><a href="#local-6989586621679152460"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152461"><a href="#local-6989586621679152461"><span class="hs-identifier">cond</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152462"><a href="#local-6989586621679152462"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152460"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-227"></a><span>    </span><span class="hs-comment">-- GNU extension (Conditionals with Omitted Operands, see also: https://gcc.gnu.org/onlinedocs/gcc/Conditionals.html)</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;?&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152463"><a href="#local-6989586621679152463"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atConditional"><span class="hs-identifier hs-var">atConditional</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152461"><span class="hs-identifier hs-var">cond</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152461"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#conditional"><span class="hs-identifier hs-var">conditional</span></a><span> </span><a href="#local-6989586621679152463"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679152461"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679152462"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-229"></a><span>    </span><a name="local-6989586621679152464"><a href="#local-6989586621679152464"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;?&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152465"><a href="#local-6989586621679152465"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152465"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679152461"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679152462"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152466"><a href="#local-6989586621679152466"><span class="hs-identifier">ert'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152467"><a href="#local-6989586621679152467"><span class="hs-identifier">thn</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152468"><a href="#local-6989586621679152468"><span class="hs-identifier">erscp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152466"><span class="hs-identifier hs-var">ert'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-230"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152469"><a href="#local-6989586621679152469"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atConditional"><span class="hs-identifier hs-var">atConditional</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152467"><span class="hs-identifier hs-var">thn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152461"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679152467"><span class="hs-identifier hs-var">thn</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#conditional"><span class="hs-identifier hs-var">conditional</span></a><span> </span><a href="#local-6989586621679152469"><span class="hs-identifier hs-var">ds'</span></a><span> </span><a href="#local-6989586621679152467"><span class="hs-identifier hs-var">thn</span></a><span> </span><a href="#local-6989586621679152468"><span class="hs-identifier hs-var">erscp'</span></a><span>
</span><a name="line-231"></a><span>        </span><a name="local-6989586621679152470"><a href="#local-6989586621679152470"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152470"><span class="hs-identifier hs-var">ds'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ':' token for this '?'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152464"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected ':' before '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152470"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' token&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152470"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152460"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152461"><span class="hs-identifier hs-var">cond</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152462"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">-- | `inners` is a general function for creating `equality`, `relational`, `add` and `term` in the following syntax (EBNF) of \({\rm LL}\left(k\right)\) where \(k\in\mathbb{N}\).</span><span>
</span><a name="line-235"></a><span class="hs-comment">--</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- \[</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- \begin{eqnarray}</span><span>
</span><a name="line-238"></a><span class="hs-comment">-- {\rm program} &amp;=&amp; \text{global-def*}\label{eq:eigth}\tag{1}\\</span><span>
</span><a name="line-239"></a><span class="hs-comment">-- {\rm stmt} &amp;=&amp; \begin{array}{l}</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- {\rm expr}?\ {\rm &quot;;&quot;}\\ </span><span>
</span><a name="line-241"></a><span class="hs-comment">-- \mid\ {\rm &quot;\{&quot;\ stmt}^\ast\ {\rm &quot;\}&quot;}\\</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- \mid\ {\rm &quot;return&quot;}\ {\rm expr}\ &quot;;&quot;\\</span><span>
</span><a name="line-243"></a><span class="hs-comment">-- \mid\ &quot;{\rm if}&quot;\ &quot;(&quot;\ {\rm expr}\ &quot;)&quot;\ {\rm stmt}\ (&quot;{\rm else}&quot;\ {\rm stmt})?\\</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- \mid\ {\rm &quot;while&quot;\ &quot;(&quot;\ expr\ &quot;)&quot;\ stmt}\\</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- \mid\ {\rm &quot;for&quot;\ &quot;(&quot;\ expr?\ &quot;;&quot; expr?\ &quot;;&quot;\ expr?\ &quot;)&quot;\ stmt? &quot;;&quot;}</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- \end{array}\label{eq:nineth}\tag{2}\\</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- {\rm expr} &amp;=&amp; {\rm assign}\\</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- {\rm assign} &amp;=&amp; {\rm conditional} \left(\left(&quot;=&quot;\ \mid\ &quot;+=&quot;\ \mid\ &quot;-=&quot;\ \mid\ &quot;*=&quot;\ \mid\ &quot;/=&quot;\right)\ {\rm assign}\right)?\label{eq:seventh}\tag{3}\\</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- {\rm conditional} &amp;=&amp; {\rm logicalOr} \left(&quot;?&quot;\ {\rm expr}\ &quot;:&quot;\ {\rm conditional}\right)?\label{eq:seventeenth}\tag{4}\\</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- {\rm logicalOr} &amp;=&amp; {\rm logicalAnd}\ \left(&quot;||&quot;\ {\rm logicalAnd}\right)^\ast\label{eq:fifteenth}\tag{5}\\</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- {\rm logicalAnd} &amp;=&amp; {\rm bitwiseOr}\ \left(&quot;|&quot;\ {\rm bitwiseOr}\right)^\ast\label{eq:sixteenth}\tag{6}\\</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- {\rm bitwiseOr} &amp;=&amp; {\rm bitwiseXor}\ \left(&quot;|&quot;\ {\rm bitwiseXor}\right)^\ast\label{eq:tenth}\tag{7}\\</span><span>
</span><a name="line-253"></a><span class="hs-comment">-- {\rm bitwiseXor} &amp;=&amp; {\rm bitwiseAnd}\ \left(&quot;\hat{}&quot;\ {\rm bitwiseAnd}\right)^\ast\label{eq:eleventh}\tag{8}\\</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- {\rm bitwiseAnd} &amp;=&amp; {\rm equality}\ \left(&quot;\&amp;&quot;\ {\rm equality}\right)^\ast\label{eq:twelveth}\tag{9}\\</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- {\rm equality} &amp;=&amp; {\rm relational}\ \left(&quot;==&quot;\ {\rm relational}\ \mid\ &quot;!=&quot;\ {\rm relational}\right)^\ast\label{eq:fifth}\tag{10}\\</span><span>
</span><a name="line-256"></a><span class="hs-comment">-- {\rm relational} &amp;=&amp; {\rm shift}\ \left(&quot;\lt&quot;\ {\rm shift}\mid\ &quot;\lt =&quot;\ {\rm shift}\mid\ &quot;\gt&quot;\ {\rm shift}\mid\ &quot;\gt =&quot;\ {\rm shift}\right)^\ast\label{eq:sixth}\tag{11}\\</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- {\rm shift} &amp;=&amp; {\rm add}\ \left(&quot;\lt\lt&quot;\ {\rm add}\mid\ &quot;\gt\gt&quot;\ {\rm add}\right)^\ast\label{eq:thirteenth}\tag{12}\\</span><span>
</span><a name="line-258"></a><span class="hs-comment">-- {\rm add} &amp;=&amp; {\rm term}\ \left(&quot;+&quot;\ {\rm term}\ \mid\ &quot;-&quot;\ {\rm term}\right)^\ast\label{eq:first}\tag{13} \\</span><span>
</span><a name="line-259"></a><span class="hs-comment">-- {\rm term} &amp;=&amp; {\rm factor}\ \left(&quot;\ast&quot;\ {\rm factor}\ \mid\ &quot;/&quot;\ {\rm factor}\right)^\ast\label{eq:second}\tag{14} \\</span><span>
</span><a name="line-260"></a><span class="hs-comment">-- {\rm cast} &amp;=&amp; &quot;(&quot; {\rm type-name} &quot;)&quot;\ {\rm cast}\ \mid\ {\rm unary}\label{eq:fourteenth}\tag{15} \\</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- {\rm unary} &amp;=&amp; \left(\text{&quot;+&quot;}\ \mid\ \text{&quot;-&quot;}\ \mid\ \text{&quot;*&quot;}\ \mid\ \text{&quot;&amp;&quot;}\ \mid\ \text{&quot;!&quot;}\ \mid\ \text{&quot;-&quot;}\right)\text{?}\ \text{cast}\ \mid\ \left(\text{&quot;++&quot;}\ \mid\ \text{&quot;--&quot;}\right)\ \text{unary}\ \mid\ \text{primary} \left(\text{&quot;[&quot;}\ \text{expr}\ \text{&quot;]&quot;}\ \mid\ \text{&quot;.&quot;}\ \text{ident}\ \mid\ \text{&quot;-&gt;&quot;}\ \text{ident}\ \mid\ \text{&quot;++&quot;}\ \mid\ \text{&quot;--&quot;}\right)\ast\label{eq:fourth}\tag{16} \\</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- {\rm factor} &amp;=&amp; {\rm num} \mid\ {\rm ident}\ \left({\rm &quot;(&quot; \left(expr\ \left(\left(&quot;,&quot;\ expr\right)^\ast\right)?\right)? &quot;)&quot;}\right)?\ \mid\ &quot;(&quot; {\rm expr} &quot;)&quot;\ \mid \text{string}\ \mid\ \text{&quot;sizeof&quot;}\ \text{&quot;(&quot;}\ \text{type}\ \text{&quot;)&quot;}\ \mid\ \text{&quot;sizeof&quot;}\ \text{unary}\ \mid\ \text{stmt-expr}\label{eq:third}\tag{17}</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- \end{eqnarray}</span><span>
</span><a name="line-264"></a><span class="hs-comment">-- \]</span><span>
</span><a name="line-265"></a><span class="hs-identifier">inners</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATKind"><span class="hs-identifier hs-type">ATKind</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152219"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-266"></a><a name="inners"><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier">inners</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679152471"><a href="#local-6989586621679152471"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152472"><a href="#local-6989586621679152472"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152471"><span class="hs-identifier hs-var">atn</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152472"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span class="hs-identifier">inners</span><span> </span><a name="local-6989586621679152473"><a href="#local-6989586621679152473"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679152474"><a href="#local-6989586621679152474"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679152475"><a href="#local-6989586621679152475"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679152476"><a href="#local-6989586621679152476"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152477"><a href="#local-6989586621679152477"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152478"><span class="hs-identifier hs-var">inners'</span></a><span> </span><a href="#local-6989586621679152473"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152474"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679152473"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152475"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152476"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152477"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-268"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-269"></a><span>        </span><a name="local-6989586621679152478"><a href="#local-6989586621679152478"><span class="hs-identifier">inners'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679152479"><a href="#local-6989586621679152479"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152480"><a href="#local-6989586621679152480"><span class="hs-identifier">ars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152479"><span class="hs-identifier hs-var">at</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152480"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span>        </span><span class="hs-identifier">inners'</span><span> </span><a name="local-6989586621679152481"><a href="#local-6989586621679152481"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679152482"><a href="#local-6989586621679152482"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679152483"><a href="#local-6989586621679152483"><span class="hs-identifier">ys</span></a></a><span> </span><a name="local-6989586621679152484"><a href="#local-6989586621679152484"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152485"><a href="#local-6989586621679152485"><span class="hs-identifier">ars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.html#maybe%27"><span class="hs-identifier hs-var">maybe'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152483"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152484"><span class="hs-identifier hs-var">at</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152485"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">find</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152486"><a href="#local-6989586621679152486"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152483"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><a name="local-6989586621679152487"><a href="#local-6989586621679152487"><span class="hs-identifier">cc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152487"><span class="hs-identifier hs-var">cc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679152486"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152482"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152488"><a href="#local-6989586621679152488"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-271"></a><span>            </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry3</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Utils.Tuple.html#first3"><span class="hs-identifier hs-var">first3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152478"><span class="hs-identifier hs-var">inners'</span></a><span> </span><a href="#local-6989586621679152473"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152474"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="#local-6989586621679152488"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152484"><span class="hs-identifier hs-var">at</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679152481"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679152483"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152484"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152485"><span class="hs-identifier hs-var">ars</span></a><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-comment">-- | `logicalOr` indicates \(\eqref{eq:fifteenth}\) among the comments of `inners`.</span><span>
</span><a name="line-274"></a><span class="hs-identifier">logicalOr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152218"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-275"></a><a name="logicalOr"><a href="Htcc.Parser.Parsing.Core.html#logicalOr"><span class="hs-identifier">logicalOr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#logicalAnd"><span class="hs-identifier hs-var">logicalAnd</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;||&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATLOr"><span class="hs-identifier hs-var">ATLOr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-comment">-- | `logicalAnd` indicates \(\eqref{eq:sixteenth}\) among the comments of `inners`.</span><span>
</span><a name="line-278"></a><span class="hs-identifier">logicalAnd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152217"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-279"></a><a name="logicalAnd"><a href="Htcc.Parser.Parsing.Core.html#logicalAnd"><span class="hs-identifier">logicalAnd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#bitwiseOr"><span class="hs-identifier hs-var">bitwiseOr</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;&amp;&amp;&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATLAnd"><span class="hs-identifier hs-var">ATLAnd</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span class="hs-comment">-- | `bitwiseOr` indicates \(\eqref{eq:tenth}\) among the comments of `inners`.</span><span>
</span><a name="line-282"></a><span class="hs-identifier">bitwiseOr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152216"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-283"></a><a name="bitwiseOr"><a href="Htcc.Parser.Parsing.Core.html#bitwiseOr"><span class="hs-identifier">bitwiseOr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#bitwiseXor"><span class="hs-identifier hs-var">bitwiseXor</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATOr"><span class="hs-identifier hs-var">ATOr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-comment">-- | `bitwiseXor` indicates \(\eqref{eq:eleventh}\) amont the comments of `inners`.</span><span>
</span><a name="line-286"></a><span class="hs-identifier">bitwiseXor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152215"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-287"></a><a name="bitwiseXor"><a href="Htcc.Parser.Parsing.Core.html#bitwiseXor"><span class="hs-identifier">bitwiseXor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#bitwiseAnd"><span class="hs-identifier hs-var">bitwiseAnd</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;^&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATXor"><span class="hs-identifier hs-var">ATXor</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-comment">-- | `bitwiseAnd` indicates \(\eqref{eq:twelveth}\) among the comments of `inners`.</span><span>
</span><a name="line-290"></a><span class="hs-identifier">bitwiseAnd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152214"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-291"></a><a name="bitwiseAnd"><a href="Htcc.Parser.Parsing.Core.html#bitwiseAnd"><span class="hs-identifier">bitwiseAnd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#equality"><span class="hs-identifier hs-var">equality</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;&amp;&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATAnd"><span class="hs-identifier hs-var">ATAnd</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">-- | `equality` indicates \(\eqref{eq:fifth}\) among the comments of `inners`.</span><span>
</span><a name="line-294"></a><span class="hs-comment">-- This is equivalent to the following code:</span><span>
</span><a name="line-295"></a><span class="hs-comment">--</span><span>
</span><a name="line-296"></a><span class="hs-comment">--</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- &gt; equality ::  [HT.TokenLC i] -&gt; ATree i -&gt; [LVar i] -&gt; Either (ASTError i) ([HT.TokenLC i], ATree i)</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- &gt; equality xs atn scp = (&gt;&gt;=) (relational xs atn scp) $ uncurry3 equality'</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- &gt;     where</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- &gt;         equality' ((_, HT.TKReserved &quot;==&quot;):ys) era ars = either Left (uncurry3 id . first3 equality' . second3 (ATNode ATEQ era)) $ relational ys era ars</span><span>
</span><a name="line-301"></a><span class="hs-comment">-- &gt;         equality' ((_, HT.TKReserved &quot;!=&quot;):ys) era ars = either Left (uncurry3 id . first3 equality' . second3 (ATNode ATNEQ era)) $ relational ys era ars</span><span>
</span><a name="line-302"></a><span class="hs-comment">-- &gt;         equality' ert era ars = Right (ert, era, ars)</span><span>
</span><a name="line-303"></a><span class="hs-identifier">equality</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152213"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-304"></a><a name="equality"><a href="Htcc.Parser.Parsing.Core.html#equality"><span class="hs-identifier">equality</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#relational"><span class="hs-identifier hs-var">relational</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;==&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEQ"><span class="hs-identifier hs-var">ATEQ</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;!=&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATNEQ"><span class="hs-identifier hs-var">ATNEQ</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">-- | `relational` indicates \(\eqref{eq:sixth}\) among the comments of `inners`.</span><span>
</span><a name="line-307"></a><span class="hs-identifier">relational</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152212"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-308"></a><a name="relational"><a href="Htcc.Parser.Parsing.Core.html#relational"><span class="hs-identifier">relational</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;&lt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATLT"><span class="hs-identifier hs-var">ATLT</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;&lt;=&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATLEQ"><span class="hs-identifier hs-var">ATLEQ</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATGT"><span class="hs-identifier hs-var">ATGT</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;&gt;=&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATGEQ"><span class="hs-identifier hs-var">ATGEQ</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">-- | `shift` indicates \(\eqref{eq:thirteenth}\\) among the comments of `inners`.</span><span>
</span><a name="line-311"></a><span class="hs-identifier">shift</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152211"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-312"></a><a name="shift"><a href="Htcc.Parser.Parsing.Core.html#shift"><span class="hs-identifier">shift</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#add"><span class="hs-identifier hs-var">add</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;&lt;&lt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATShl"><span class="hs-identifier hs-var">ATShl</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;&gt;&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATShr"><span class="hs-identifier hs-var">ATShr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-comment">-- | `add` indicates \(\eqref{eq:first}\) among the comments of `inners`.</span><span>
</span><a name="line-315"></a><span class="hs-identifier">add</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152210"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-316"></a><a name="add"><a href="Htcc.Parser.Parsing.Core.html#add"><span class="hs-identifier">add</span></a></a><span> </span><a name="local-6989586621679152489"><a href="#local-6989586621679152489"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679152490"><a href="#local-6989586621679152490"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152491"><a href="#local-6989586621679152491"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#term"><span class="hs-identifier hs-var">term</span></a><span> </span><a href="#local-6989586621679152489"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152490"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152491"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">uncurry3</span><span> </span><a href="#local-6989586621679152492"><span class="hs-identifier hs-var">add'</span></a><span>
</span><a name="line-317"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-318"></a><span>        </span><a name="local-6989586621679152492"><a href="#local-6989586621679152492"><span class="hs-identifier">add'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152493"><a href="#local-6989586621679152493"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;+&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152494"><a href="#local-6989586621679152494"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152495"><a href="#local-6989586621679152495"><span class="hs-identifier">era</span></a></a><span> </span><a name="local-6989586621679152496"><a href="#local-6989586621679152496"><span class="hs-identifier">ars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#term"><span class="hs-identifier hs-var">term</span></a><span> </span><a href="#local-6989586621679152494"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152495"><span class="hs-identifier hs-var">era</span></a><span> </span><a href="#local-6989586621679152496"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152497"><a href="#local-6989586621679152497"><span class="hs-identifier">zz</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-319"></a><span>            </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid operands&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152493"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.DeduceKind.html#addKind"><span class="hs-identifier hs-var">addKind</span></a><span> </span><a href="#local-6989586621679152495"><span class="hs-identifier hs-var">era</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd3</span><span> </span><a href="#local-6989586621679152497"><span class="hs-identifier hs-var">zz</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152498"><a href="#local-6989586621679152498"><span class="hs-identifier">nat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">uncurry3</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Tuple.html#first3"><span class="hs-identifier hs-var">first3</span></a><span> </span><a href="#local-6989586621679152492"><span class="hs-identifier hs-var">add'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679152498"><span class="hs-identifier hs-var">nat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152497"><span class="hs-identifier hs-var">zz</span></a><span>
</span><a name="line-320"></a><span>        </span><span class="hs-identifier">add'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152499"><a href="#local-6989586621679152499"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;-&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152500"><a href="#local-6989586621679152500"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152501"><a href="#local-6989586621679152501"><span class="hs-identifier">era</span></a></a><span> </span><a name="local-6989586621679152502"><a href="#local-6989586621679152502"><span class="hs-identifier">ars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#term"><span class="hs-identifier hs-var">term</span></a><span> </span><a href="#local-6989586621679152500"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152501"><span class="hs-identifier hs-var">era</span></a><span> </span><a href="#local-6989586621679152502"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152503"><a href="#local-6989586621679152503"><span class="hs-identifier">zz</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-321"></a><span>            </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid operands&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152499"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.DeduceKind.html#subKind"><span class="hs-identifier hs-var">subKind</span></a><span> </span><a href="#local-6989586621679152501"><span class="hs-identifier hs-var">era</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd3</span><span> </span><a href="#local-6989586621679152503"><span class="hs-identifier hs-var">zz</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152504"><a href="#local-6989586621679152504"><span class="hs-identifier">nat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">uncurry3</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Tuple.html#first3"><span class="hs-identifier hs-var">first3</span></a><span> </span><a href="#local-6989586621679152492"><span class="hs-identifier hs-var">add'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679152504"><span class="hs-identifier hs-var">nat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152503"><span class="hs-identifier hs-var">zz</span></a><span>
</span><a name="line-322"></a><span>        </span><span class="hs-identifier">add'</span><span> </span><a name="local-6989586621679152505"><a href="#local-6989586621679152505"><span class="hs-identifier">ert</span></a></a><span> </span><a name="local-6989586621679152506"><a href="#local-6989586621679152506"><span class="hs-identifier">erat</span></a></a><span> </span><a name="local-6989586621679152507"><a href="#local-6989586621679152507"><span class="hs-identifier">ars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152505"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152506"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152507"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">)</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-comment">-- | `term` indicates \(\eqref{eq:second}\) amont the comments of `inners`.</span><span>
</span><a name="line-325"></a><span class="hs-identifier">term</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152209"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-326"></a><a name="term"><a href="Htcc.Parser.Parsing.Core.html#term"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#inners"><span class="hs-identifier hs-var">inners</span></a><span> </span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;*&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATMul"><span class="hs-identifier hs-var">ATMul</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;/&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATDiv"><span class="hs-identifier hs-var">ATDiv</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;%&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATMod"><span class="hs-identifier hs-var">ATMod</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- | `cast` indicates \(\eqref{eq:fourteenth}\) amont the comments of `inners`.</span><span>
</span><a name="line-329"></a><span class="hs-identifier">cast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152208"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-330"></a><a name="cast"><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier">cast</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152508"><a href="#local-6989586621679152508"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152509"><a href="#local-6989586621679152509"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152510"><a href="#local-6989586621679152510"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152511"><a href="#local-6989586621679152511"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152508"><span class="hs-identifier hs-var">cur</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152509"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152510"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152511"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Type.html#takeTypeName"><span class="hs-identifier hs-var">takeTypeName</span></a><span> </span><a href="#local-6989586621679152509"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152511"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-331"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679152512"><a href="#local-6989586621679152512"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152513"><a href="#local-6989586621679152513"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atCast"><span class="hs-identifier hs-var">atCast</span></a><span> </span><a href="#local-6989586621679152512"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621679152513"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621679152510"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152511"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-332"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;The token ')' corresponding to '(' is expected&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152508"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span class="hs-identifier">cast</span><span> </span><a name="local-6989586621679152514"><a href="#local-6989586621679152514"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679152515"><a href="#local-6989586621679152515"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152516"><a href="#local-6989586621679152516"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="#local-6989586621679152514"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152515"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152516"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | `unary` indicates \(\eqref{eq:fourth}\) amount the comments of `inners`.</span><span>
</span><a name="line-336"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152207"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-337"></a><a name="unary"><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier">unary</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;+&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152517"><a href="#local-6989586621679152517"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152518"><a href="#local-6989586621679152518"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152519"><a href="#local-6989586621679152519"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621679152517"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152518"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152519"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-338"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;-&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152520"><a href="#local-6989586621679152520"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152521"><a href="#local-6989586621679152521"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152522"><a href="#local-6989586621679152522"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATSub"><span class="hs-identifier hs-var">ATSub</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atNumLit"><span class="hs-identifier hs-var">atNumLit</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621679152520"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152521"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152522"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-339"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;!&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152523"><a href="#local-6989586621679152523"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152524"><a href="#local-6989586621679152524"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152525"><a href="#local-6989586621679152525"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATNot"><span class="hs-identifier hs-var">ATNot</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a><span class="hs-special">)</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621679152523"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152524"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152525"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-340"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;~&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152526"><a href="#local-6989586621679152526"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152527"><a href="#local-6989586621679152527"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152528"><a href="#local-6989586621679152528"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATBitNot"><span class="hs-identifier hs-var">ATBitNot</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a><span class="hs-special">)</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621679152526"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152527"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152528"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-341"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;&amp;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152529"><a href="#local-6989586621679152529"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152530"><a href="#local-6989586621679152530"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152531"><a href="#local-6989586621679152531"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621679152529"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152530"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152531"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152532"><a href="#local-6989586621679152532"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152533"><a href="#local-6989586621679152533"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#isCTArray"><span class="hs-identifier hs-var">CT.isCTArray</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152532"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152532"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152532"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-342"></a><span>    </span><a href="Htcc.Parser.AST.Core.html#atUnary"><span class="hs-identifier hs-var">atUnary</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAddr"><span class="hs-identifier hs-var">ATAddr</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#mapTypeKind"><span class="hs-identifier hs-var">CT.mapTypeKind</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTPtr"><span class="hs-identifier hs-var">CT.CTPtr</span></a><span> </span><a href="#local-6989586621679152533"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152532"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-343"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152534"><a href="#local-6989586621679152534"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;*&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152535"><a href="#local-6989586621679152535"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152536"><a href="#local-6989586621679152536"><span class="hs-identifier">at</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152537"><a href="#local-6989586621679152537"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#cast"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621679152535"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152536"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152537"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152538"><a href="#local-6989586621679152538"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152539"><a href="#local-6989586621679152539"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152540"><a href="#local-6989586621679152540"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-344"></a><span>    </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid pointer dereference&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152534"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152539"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152541"><a href="#local-6989586621679152541"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679152541"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-345"></a><span>        </span><a href="Htcc.CRules.Types.TypeKind.html#CTVoid"><span class="hs-identifier hs-var">CT.CTVoid</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;void value not ignored as it ought to be&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152534"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-346"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152542"><a href="#local-6989586621679152542"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679152538"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atUnary"><span class="hs-identifier hs-var">atUnary</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATDeref"><span class="hs-identifier hs-var">ATDeref</span></a><span> </span><a href="#local-6989586621679152542"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679152539"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152540"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;incomplete value dereference&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152534"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><a href="#local-6989586621679152541"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679152537"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;++&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152543"><a href="#local-6989586621679152543"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152544"><a href="#local-6989586621679152544"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152545"><a href="#local-6989586621679152545"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152546"><a href="#local-6989586621679152546"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPreInc"><span class="hs-identifier hs-var">ATPreInc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152546"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152546"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="#local-6989586621679152543"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152544"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152545"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-348"></a><span class="hs-identifier">unary</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;--&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152547"><a href="#local-6989586621679152547"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152548"><a href="#local-6989586621679152548"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152549"><a href="#local-6989586621679152549"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152550"><a href="#local-6989586621679152550"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPreDec"><span class="hs-identifier hs-var">ATPreDec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152550"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152550"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="#local-6989586621679152547"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152548"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152549"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-349"></a><span class="hs-identifier">unary</span><span> </span><a name="local-6989586621679152551"><a href="#local-6989586621679152551"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679152552"><a href="#local-6989586621679152552"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679152553"><a href="#local-6989586621679152553"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry3</span><span> </span><a href="#local-6989586621679152554"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#factor"><span class="hs-identifier hs-var">factor</span></a><span> </span><a href="#local-6989586621679152551"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152552"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152553"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-350"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-351"></a><span>        </span><a name="local-6989586621679152554"><a href="#local-6989586621679152554"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152555"><a href="#local-6989586621679152555"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;[&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152556"><a href="#local-6989586621679152556"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152557"><a href="#local-6989586621679152557"><span class="hs-identifier">erat</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152558"><a href="#local-6989586621679152558"><span class="hs-identifier">erscp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152556"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621679152557"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152558"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152559"><a href="#local-6989586621679152559"><span class="hs-identifier">ert'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152560"><a href="#local-6989586621679152560"><span class="hs-identifier">erat'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152561"><a href="#local-6989586621679152561"><span class="hs-identifier">erscp'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152559"><span class="hs-identifier hs-var">ert'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-352"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152562"><a href="#local-6989586621679152562"><span class="hs-identifier">xs''</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid operands&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152555"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.DeduceKind.html#addKind"><span class="hs-identifier hs-var">addKind</span></a><span> </span><a href="#local-6989586621679152557"><span class="hs-identifier hs-var">erat</span></a><span> </span><a href="#local-6989586621679152560"><span class="hs-identifier hs-var">erat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152563"><a href="#local-6989586621679152563"><span class="hs-identifier">erat''</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-353"></a><span>                </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;subscripted value is neither array nor pointer nor vector&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#altEmptyToken"><span class="hs-identifier hs-var">HT.altEmptyToken</span></a><span> </span><a href="#local-6989586621679152551"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152563"><span class="hs-identifier hs-var">erat''</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152564"><a href="#local-6989586621679152564"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-354"></a><span>                    </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;incomplete value dereference&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152555"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><a href="#local-6989586621679152564"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152561"><span class="hs-identifier hs-var">erscp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152565"><a href="#local-6989586621679152565"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152554"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152562"><span class="hs-identifier hs-var">xs''</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atUnary"><span class="hs-identifier hs-var">atUnary</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATDeref"><span class="hs-identifier hs-var">ATDeref</span></a><span> </span><a href="#local-6989586621679152565"><span class="hs-identifier hs-var">t'</span></a><span> </span><a href="#local-6989586621679152563"><span class="hs-identifier hs-var">erat''</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152561"><span class="hs-identifier hs-var">erscp'</span></a><span>
</span><a name="line-355"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152559"><span class="hs-identifier hs-var">ert'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected expression after '[' token&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152555"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected expression before '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152559"><span class="hs-identifier hs-var">ert'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' token&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152559"><span class="hs-identifier hs-var">ert'</span></a><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152566"><a href="#local-6989586621679152566"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;.&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152567"><a href="#local-6989586621679152567"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152568"><a href="#local-6989586621679152568"><span class="hs-identifier">erat</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152569"><a href="#local-6989586621679152569"><span class="hs-identifier">erscp</span></a></a><span>
</span><a name="line-357"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#isCTStruct"><span class="hs-identifier hs-var">CT.isCTStruct</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152568"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#isIncompleteStruct"><span class="hs-identifier hs-var">CT.isIncompleteStruct</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152568"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152567"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected identifier at end of input&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152566"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152567"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-358"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152570"><a href="#local-6989586621679152570"><span class="hs-identifier">ident</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;incomplete type '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152568"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152566"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152568"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152569"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152571"><a href="#local-6989586621679152571"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-359"></a><span>                    </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;no such member&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152566"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#lookupMember"><span class="hs-identifier hs-var">CT.lookupMember</span></a><span> </span><a href="#local-6989586621679152570"><span class="hs-identifier hs-var">ident</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679152571"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152572"><a href="#local-6989586621679152572"><span class="hs-identifier">mem</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-360"></a><span>                        </span><a href="#local-6989586621679152554"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679152567"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atMemberAcc"><span class="hs-identifier hs-var">atMemberAcc</span></a><span> </span><a href="#local-6989586621679152572"><span class="hs-identifier hs-var">mem</span></a><span> </span><a href="#local-6989586621679152568"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152569"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-361"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected identifier after '.' token&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152566"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;request for a member in something not a structure or union&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152566"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152573"><a href="#local-6989586621679152573"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;-&gt;&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152574"><a href="#local-6989586621679152574"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152575"><a href="#local-6989586621679152575"><span class="hs-identifier">erat</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152576"><a href="#local-6989586621679152576"><span class="hs-identifier">erscp</span></a></a><span>
</span><a name="line-364"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#isCTStruct"><span class="hs-identifier hs-var">CT.isCTStruct</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152575"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#isIncompleteStruct"><span class="hs-identifier hs-var">CT.isIncompleteStruct</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152575"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152574"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected identifier at end of input&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152573"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span>
</span><a name="line-365"></a><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152574"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-366"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152577"><a href="#local-6989586621679152577"><span class="hs-identifier">ident</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;incomplete type '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152575"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152573"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.CType.html#deref"><span class="hs-identifier hs-var">CT.deref</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152575"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152576"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152578"><a href="#local-6989586621679152578"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-367"></a><span>                        </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;no such member&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152573"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#lookupMember"><span class="hs-identifier hs-var">CT.lookupMember</span></a><span> </span><a href="#local-6989586621679152577"><span class="hs-identifier hs-var">ident</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679152578"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152579"><a href="#local-6989586621679152579"><span class="hs-identifier">mem</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-368"></a><span>                            </span><a href="#local-6989586621679152554"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679152574"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atMemberAcc"><span class="hs-identifier hs-var">atMemberAcc</span></a><span> </span><a href="#local-6989586621679152579"><span class="hs-identifier hs-var">mem</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atUnary"><span class="hs-identifier hs-var">atUnary</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATDeref"><span class="hs-identifier hs-var">ATDeref</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">CT.smType</span><span> </span><a href="#local-6989586621679152579"><span class="hs-identifier hs-var">mem</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152575"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152576"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-369"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;expected identifier after '-&gt;' token&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152573"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid type argument of '-&gt;'&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#isCTUndef"><span class="hs-identifier hs-var">CT.isCTUndef</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152575"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot; (have '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152575"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;')&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152573"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;++&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152580"><a href="#local-6989586621679152580"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152581"><a href="#local-6989586621679152581"><span class="hs-identifier">erat</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152582"><a href="#local-6989586621679152582"><span class="hs-identifier">erscp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152554"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152580"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atUnary"><span class="hs-identifier hs-var">atUnary</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPostInc"><span class="hs-identifier hs-var">ATPostInc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152581"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152581"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152582"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-372"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;--&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152583"><a href="#local-6989586621679152583"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152584"><a href="#local-6989586621679152584"><span class="hs-identifier">erat</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152585"><a href="#local-6989586621679152585"><span class="hs-identifier">erscp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152554"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152583"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atUnary"><span class="hs-identifier hs-var">atUnary</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPostDec"><span class="hs-identifier hs-var">ATPostDec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152584"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152584"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152585"><span class="hs-identifier hs-var">erscp</span></a><span>
</span><a name="line-373"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679152586"><a href="#local-6989586621679152586"><span class="hs-identifier">ert</span></a></a><span> </span><a name="local-6989586621679152587"><a href="#local-6989586621679152587"><span class="hs-identifier">erat</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152588"><a href="#local-6989586621679152588"><span class="hs-identifier">erscp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152586"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152587"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152588"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-- | `factor` indicates \(\eqref{eq:third}\) amount the comments of `inners`.</span><span>
</span><a name="line-376"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTConstruction"><span class="hs-identifier hs-type">ASTConstruction</span></a><span> </span><a href="#local-6989586621679152206"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-377"></a><a name="factor"><a href="Htcc.Parser.Parsing.Core.html#factor"><span class="hs-identifier">factor</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679152589"><a href="#local-6989586621679152589"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152590"><a href="#local-6989586621679152590"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152589"><span class="hs-identifier hs-var">atn</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152590"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span class="hs-identifier">factor</span><span> </span><a name="local-6989586621679152591"><a href="#local-6989586621679152591"><span class="hs-identifier">tk</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;{&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679152592"><a href="#local-6989586621679152592"><span class="hs-identifier">at</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152593"><a href="#local-6989586621679152593"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Parser.Parsing.StmtExpr.html#stmtExpr"><span class="hs-identifier hs-var">stmtExpr</span></a><span> </span><a href="#local-6989586621679152591"><span class="hs-identifier hs-var">tk</span></a><span> </span><a href="#local-6989586621679152592"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679152593"><span class="hs-identifier hs-var">scp</span></a><span>
</span><a name="line-379"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152594"><a href="#local-6989586621679152594"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152595"><a href="#local-6989586621679152595"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152596"><a href="#local-6989586621679152596"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152597"><a href="#local-6989586621679152597"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152595"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152596"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152597"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152598"><a href="#local-6989586621679152598"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152599"><a href="#local-6989586621679152599"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152600"><a href="#local-6989586621679152600"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152598"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for (expr)</span><span>
</span><a name="line-380"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152601"><a href="#local-6989586621679152601"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152601"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152599"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152600"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span>
</span><a name="line-381"></a><span>    </span><a name="local-6989586621679152602"><a href="#local-6989586621679152602"><span class="hs-identifier">ert'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Parser.Utils.Core.html#expectedMessage"><span class="hs-identifier hs-var">expectedMessage</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span> </span><a href="#local-6989586621679152594"><span class="hs-identifier hs-var">cur</span></a><span> </span><a href="#local-6989586621679152602"><span class="hs-identifier hs-var">ert'</span></a><span>
</span><a name="line-382"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKNum"><span class="hs-identifier hs-var">HT.TKNum</span></a><span> </span><a name="local-6989586621679152603"><a href="#local-6989586621679152603"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152604"><a href="#local-6989586621679152604"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152605"><a href="#local-6989586621679152605"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152604"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atNumLit"><span class="hs-identifier hs-var">atNumLit</span></a><span> </span><a href="#local-6989586621679152603"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152605"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for numbers</span><span>
</span><a name="line-383"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152606"><a href="#local-6989586621679152606"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152607"><a href="#local-6989586621679152607"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152608"><a href="#local-6989586621679152608"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152609"><a href="#local-6989586621679152609"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#lookupFunction"><span class="hs-identifier hs-var">lookupFunction</span></a><span> </span><a href="#local-6989586621679152607"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679152609"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for no arguments function call</span><span>
</span><a name="line-384"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152608"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atNoLeaf"><span class="hs-identifier hs-var">atNoLeaf</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCallFunc"><span class="hs-identifier hs-var">ATCallFunc</span></a><span> </span><a href="#local-6989586621679152607"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#pushWarn"><span class="hs-identifier hs-var">pushWarn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;the function '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679152607"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' is not declared.&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152606"><span class="hs-identifier hs-var">cur</span></a><span> </span><a href="#local-6989586621679152609"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679152610"><a href="#local-6989586621679152610"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152608"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atNoLeaf"><span class="hs-identifier hs-var">atNoLeaf</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCallFunc"><span class="hs-identifier hs-var">ATCallFunc</span></a><span> </span><a href="#local-6989586621679152607"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PSF.fntype</span><span> </span><a href="#local-6989586621679152610"><span class="hs-identifier hs-var">fn</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152609"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152611"><a href="#local-6989586621679152611"><span class="hs-identifier">cur1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152612"><a href="#local-6989586621679152612"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152613"><a href="#local-6989586621679152613"><span class="hs-identifier">cur2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152614"><a href="#local-6989586621679152614"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152615"><a href="#local-6989586621679152615"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152611"><span class="hs-identifier hs-var">cur1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Utils.Core.html#takeBrace"><span class="hs-identifier hs-var">takeBrace</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152613"><span class="hs-identifier hs-var">cur2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152614"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-comment">-- for some argumets function call</span><span>
</span><a name="line-387"></a><span>    </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid function call&quot;</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152628"><a href="#local-6989586621679152628"><span class="hs-identifier">fsec</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152629"><a href="#local-6989586621679152629"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#lookupFunction"><span class="hs-identifier hs-var">lookupFunction</span></a><span> </span><a href="#local-6989586621679152612"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679152615"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-388"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152616"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152628"><span class="hs-identifier hs-var">fsec</span></a><span> </span><a href="#local-6989586621679152629"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#pushWarn"><span class="hs-identifier hs-var">pushWarn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;The function '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679152611"><span class="hs-identifier hs-var">cur1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' is not declared.&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152611"><span class="hs-identifier hs-var">cur1</span></a><span> </span><a href="#local-6989586621679152615"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a><span>
</span><a name="line-389"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679152630"><a href="#local-6989586621679152630"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152616"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152628"><span class="hs-identifier hs-var">fsec</span></a><span> </span><a href="#local-6989586621679152629"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679152615"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">PSF.fntype</span><span> </span><a href="#local-6989586621679152630"><span class="hs-identifier hs-var">fn</span></a><span class="hs-special">)</span><span>
</span><a name="line-390"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-391"></a><span>        </span><a name="local-6989586621679152616"><a href="#local-6989586621679152616"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679152617"><a href="#local-6989586621679152617"><span class="hs-identifier">fsec</span></a></a><span> </span><a name="local-6989586621679152618"><a href="#local-6989586621679152618"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679152619"><a href="#local-6989586621679152619"><span class="hs-identifier">scp'</span></a></a><span> </span><a name="local-6989586621679152620"><a href="#local-6989586621679152620"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid function call&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152611"><span class="hs-identifier hs-var">cur1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Utils.Core.html#takeExps"><span class="hs-identifier hs-var">takeExps</span></a><span> </span><a href="#local-6989586621679152617"><span class="hs-identifier hs-var">fsec</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152621"><a href="#local-6989586621679152621"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-392"></a><span>            </span><a name="local-6989586621679152622"><a href="#local-6989586621679152622"><span class="hs-identifier">mk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><a href="#local-6989586621679152619"><span class="hs-identifier hs-var">scp'</span></a><span>
</span><a name="line-393"></a><span>            </span><a name="local-6989586621679152626"><a href="#local-6989586621679152626"><span class="hs-identifier">expl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">forM</span><span> </span><a href="#local-6989586621679152621"><span class="hs-identifier hs-var">exps</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152623"><a href="#local-6989586621679152623"><span class="hs-identifier">etk</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679152622"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Left</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679152624"><a href="#local-6989586621679152624"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152625"><a href="#local-6989586621679152625"><span class="hs-identifier">ervar</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679152624"><span class="hs-identifier hs-var">erat</span></a><span> </span><span class="hs-operator hs-var">&lt;$</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679152622"><span class="hs-identifier hs-var">mk</span></a><span> </span><a href="#local-6989586621679152625"><span class="hs-identifier hs-var">ervar</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679152623"><span class="hs-identifier hs-var">etk</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span>
</span><a name="line-394"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-identifier hs-var">isLeft</span><span> </span><a href="#local-6989586621679152626"><span class="hs-identifier hs-var">expl</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">lefts</span><span> </span><a href="#local-6989586621679152626"><span class="hs-identifier hs-var">expl</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-395"></a><span>                </span><a name="local-6989586621679152627"><a href="#local-6989586621679152627"><span class="hs-identifier">scp''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679152622"><span class="hs-identifier hs-var">mk</span></a><span>
</span><a name="line-396"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152618"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atNoLeaf"><span class="hs-identifier hs-var">atNoLeaf</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCallFunc"><span class="hs-identifier hs-var">ATCallFunc</span></a><span> </span><a href="#local-6989586621679152612"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">rights</span><span> </span><a href="#local-6989586621679152626"><span class="hs-identifier hs-var">expl</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152620"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152627"><span class="hs-identifier hs-var">scp''</span></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152631"><a href="#local-6989586621679152631"><span class="hs-identifier">cur0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKSizeof"><span class="hs-identifier hs-var">HT.TKSizeof</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152632"><a href="#local-6989586621679152632"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152633"><a href="#local-6989586621679152633"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152634"><a href="#local-6989586621679152634"><span class="hs-identifier">atn</span></a></a><span> </span><a name="local-6989586621679152635"><a href="#local-6989586621679152635"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Htcc.Parser.Parsing.Type.html#takeTypeName"><span class="hs-identifier hs-var">takeTypeName</span></a><span> </span><a href="#local-6989586621679152633"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152635"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atNumLit"><span class="hs-identifier hs-var">atNumLit</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.CRules.Types.CType.html#sizeof"><span class="hs-identifier hs-var">CT.sizeof</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">atype</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152632"><span class="hs-identifier hs-var">cur</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152633"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152634"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152635"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-comment">-- for `sizeof(variable)`</span><span>
</span><a name="line-399"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152636"><a href="#local-6989586621679152636"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152637"><a href="#local-6989586621679152637"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152637"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152635"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Parser.AST.Core.html#atNumLit"><span class="hs-identifier hs-var">atNumLit</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.CRules.Types.CType.html#sizeof"><span class="hs-identifier hs-var">CT.sizeof</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span>
</span><a name="line-400"></a><span>        </span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;invalid application of 'sizeof' to incomplete type '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679152636"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152631"><span class="hs-identifier hs-var">cur0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a><span> </span><a href="#local-6989586621679152636"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152635"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;The token ')' corresponding to '(' is expected&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152632"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKSizeof"><span class="hs-identifier hs-var">HT.TKSizeof</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152638"><a href="#local-6989586621679152638"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152639"><a href="#local-6989586621679152639"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152640"><a href="#local-6989586621679152640"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Utils.Tuple.html#second3"><span class="hs-identifier hs-var">second3</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#atNumLit"><span class="hs-identifier hs-var">atNumLit</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.CRules.Types.CType.html#sizeof"><span class="hs-identifier hs-var">CT.sizeof</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">atype</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="#local-6989586621679152638"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152639"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152640"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-comment">-- for `sizeof variable` -- TODO: the type of sizeof must be @size_t@</span><span>
</span><a name="line-403"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152641"><a href="#local-6989586621679152641"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKAlignof"><span class="hs-identifier hs-var">HT.TKAlignof</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152642"><a href="#local-6989586621679152642"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152643"><a href="#local-6989586621679152643"><span class="hs-identifier">atn</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152644"><a href="#local-6989586621679152644"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.Parsing.Core.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="#local-6989586621679152642"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152643"><span class="hs-identifier hs-var">atn</span></a><span> </span><a href="#local-6989586621679152644"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152645"><a href="#local-6989586621679152645"><span class="hs-identifier">ert</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152646"><a href="#local-6989586621679152646"><span class="hs-identifier">erat</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152647"><a href="#local-6989586621679152647"><span class="hs-identifier">erscp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-404"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#isCTUndef"><span class="hs-identifier hs-var">CT.isCTUndef</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152646"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;_Alignof must be an expression or type&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152641"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152645"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atNumLit"><span class="hs-identifier hs-var">atNumLit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.CType.html#alignof"><span class="hs-identifier hs-var">CT.alignof</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">atype</span><span> </span><a href="#local-6989586621679152646"><span class="hs-identifier hs-var">erat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152647"><span class="hs-identifier hs-var">erscp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Note: Using alignof for expressions is a non-standard feature of C11</span><span>
</span><a name="line-405"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152648"><a href="#local-6989586621679152648"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKString"><span class="hs-identifier hs-var">HT.TKString</span></a><span> </span><a name="local-6989586621679152649"><a href="#local-6989586621679152649"><span class="hs-identifier">slit</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152650"><a href="#local-6989586621679152650"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152651"><a href="#local-6989586621679152651"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152650"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#addLiteral"><span class="hs-identifier hs-var">addLiteral</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTArray"><span class="hs-identifier hs-var">CT.CTArray</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">B.length</span><span> </span><a href="#local-6989586621679152649"><span class="hs-identifier hs-var">slit</span></a><span class="hs-special">)</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTChar"><span class="hs-identifier hs-var">CT.CTChar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152648"><span class="hs-identifier hs-var">cur</span></a><span> </span><a href="#local-6989586621679152651"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-comment">-- for literals</span><span>
</span><a name="line-406"></a><span class="hs-identifier">factor</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152652"><a href="#local-6989586621679152652"><span class="hs-identifier">cur</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-var">HT.TKIdent</span></a><span> </span><a name="local-6989586621679152653"><a href="#local-6989586621679152653"><span class="hs-identifier">ident</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679152654"><a href="#local-6989586621679152654"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152655"><a href="#local-6989586621679152655"><span class="hs-identifier">scp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#lookupVar"><span class="hs-identifier hs-var">lookupVar</span></a><span> </span><a href="#local-6989586621679152653"><span class="hs-identifier hs-var">ident</span></a><span> </span><a href="#local-6989586621679152655"><span class="hs-identifier hs-var">scp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-407"></a><span>    </span><a href="Htcc.Parser.ConstructionData.Scope.html#FoundGVar"><span class="hs-identifier hs-var">FoundGVar</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.ConstructionData.Scope.Var.html#GVar"><span class="hs-identifier hs-var">PV.GVar</span></a><span> </span><a name="local-6989586621679152656"><a href="#local-6989586621679152656"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152654"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#atGVar"><span class="hs-identifier hs-var">atGVar</span></a><span> </span><a href="#local-6989586621679152656"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152653"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152655"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for declared global variable</span><span>
</span><a name="line-408"></a><span>    </span><a href="Htcc.Parser.ConstructionData.Scope.html#FoundLVar"><span class="hs-identifier hs-var">FoundLVar</span></a><span> </span><a name="local-6989586621679152657"><a href="#local-6989586621679152657"><span class="hs-identifier">sct</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152654"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#treealize"><span class="hs-identifier hs-var">treealize</span></a><span> </span><a href="#local-6989586621679152657"><span class="hs-identifier hs-var">sct</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152655"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for declared local variable</span><span>
</span><a name="line-409"></a><span>    </span><a href="Htcc.Parser.ConstructionData.Scope.html#FoundEnum"><span class="hs-identifier hs-var">FoundEnum</span></a><span> </span><a name="local-6989586621679152658"><a href="#local-6989586621679152658"><span class="hs-identifier">sct</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152654"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#treealize"><span class="hs-identifier hs-var">treealize</span></a><span> </span><a href="#local-6989586621679152658"><span class="hs-identifier hs-var">sct</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152655"><span class="hs-identifier hs-var">scp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for declared enumerator</span><span>
</span><a name="line-410"></a><span>    </span><a href="Htcc.Parser.ConstructionData.Scope.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;The '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679152653"><span class="hs-identifier hs-var">ident</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' is not defined variable&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152652"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span class="hs-identifier">factor</span><span> </span><a name="local-6989586621679152659"><a href="#local-6989586621679152659"><span class="hs-identifier">ert</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679152659"><span class="hs-identifier hs-var">ert</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;unexpected token in program&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;unexpected token '&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679152659"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;' in program&quot;</span><span class="hs-special">,</span><span> </span><a href="Htcc.Tokenizer.Token.html#altEmptyToken"><span class="hs-identifier hs-var">HT.altEmptyToken</span></a><span> </span><a href="#local-6989586621679152659"><span class="hs-identifier hs-var">ert</span></a><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">parse</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-414"></a><span class="hs-comment">-- | Constructs the abstract syntax tree based on the list of token strings.</span><span>
</span><a name="line-415"></a><span class="hs-comment">-- if construction fails, `parse` returns the error message and the token at the error location.</span><span>
</span><a name="line-416"></a><span class="hs-comment">-- Otherwise, `parse` returns a list of abstract syntax trees, a set of global variables, and a list of literals.</span><span>
</span><a name="line-417"></a><span class="hs-identifier">parse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152205"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679152205"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152205"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679152205"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a><span> </span><a href="#local-6989586621679152205"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTResult"><span class="hs-identifier hs-type">ASTResult</span></a><span> </span><a href="#local-6989586621679152205"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-418"></a><a name="parse"><a href="Htcc.Parser.Parsing.Core.html#parse"><span class="hs-identifier">parse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152660"><a href="#local-6989586621679152660"><span class="hs-identifier">ast</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152661"><a href="#local-6989586621679152661"><span class="hs-identifier">sc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">warns</span><span> </span><a href="#local-6989586621679152661"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152660"><span class="hs-identifier hs-var">ast</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">PV.globals</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">vars</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">scope</span><span> </span><a href="#local-6989586621679152661"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">PV.literals</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">vars</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">scope</span><span> </span><a href="#local-6989586621679152661"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Htcc.Parser.Parsing.Core.html#program"><span class="hs-identifier hs-var">program</span></a><span> </span><a href="Htcc.Parser.ConstructionData.Core.html#initConstructionData"><span class="hs-identifier hs-var">initConstructionData</span></a><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-comment">-- | `stackSize` returns the stack size of variable per function.</span><span>
</span><a name="line-421"></a><span class="hs-identifier">stackSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679152204"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679152204"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679152204"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span>
</span><a name="line-422"></a><a name="stackSize"><a href="Htcc.Parser.Parsing.Core.html#stackSize"><span class="hs-identifier">stackSize</span></a></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATDefFunc"><span class="hs-identifier hs-var">ATDefFunc</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152662"><a href="#local-6989586621679152662"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152663"><a href="#local-6989586621679152663"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152697"><a href="#local-6989586621679152697"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152663"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">S.empty</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATLVar"><span class="hs-identifier hs-var">ATLVar</span></a><span> </span><a name="local-6989586621679152698"><a href="#local-6989586621679152698"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679152699"><a href="#local-6989586621679152699"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679152700"><a href="#local-6989586621679152700"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">S.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152698"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152699"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152700"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">S.empty</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152662"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-423"></a><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">S.size</span><span> </span><a href="#local-6989586621679152697"><span class="hs-identifier hs-var">ms</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier hs-var">toNatural</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#alignas"><span class="hs-identifier hs-var">CT.alignas</span></a><span> </span><span class="hs-number">8</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Utils.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.CRules.Types.CType.html#sizeof"><span class="hs-identifier hs-var">CT.sizeof</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S.toList</span><span> </span><a href="#local-6989586621679152697"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier hs-var">toNatural</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Htcc.CRules.Types.TypeKind.html#alignas"><span class="hs-identifier hs-var">CT.alignas</span></a><span> </span><span class="hs-number">8</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-424"></a><span>        </span><span class="hs-identifier hs-var">first</span><span> </span><span class="hs-special">(</span><a href="Htcc.Utils.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.CRules.Types.CType.html#sizeof"><span class="hs-identifier hs-var">CT.sizeof</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">second</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">dupe</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152701"><a href="#local-6989586621679152701"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621679152702"><a href="#local-6989586621679152702"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679152701"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679152702"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679152702"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679152701"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.StorageClass.html#SCUndef"><span class="hs-identifier hs-var">CT.SCUndef</span></a><span> </span><a href="Htcc.CRules.Types.TypeKind.html#CTUndef"><span class="hs-identifier hs-var">CT.CTUndef</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">S.toList</span><span> </span><a href="#local-6989586621679152697"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-425"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-426"></a><span>        </span><a name="local-6989586621679152664"><a href="#local-6989586621679152664"><span class="hs-identifier">f</span></a></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152665"><a href="#local-6989586621679152665"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152665"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-427"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCallFunc"><span class="hs-identifier hs-var">ATCallFunc</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679152666"><a href="#local-6989586621679152666"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679152667"><a href="#local-6989586621679152667"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679152668"><a href="#local-6989586621679152668"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679152669"><a href="#local-6989586621679152669"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152670"><a href="#local-6989586621679152670"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATBlock"><span class="hs-identifier hs-var">ATBlock</span></a><span> </span><a href="#local-6989586621679152666"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152667"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152668"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679152669"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152670"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-428"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATLVar"><span class="hs-identifier hs-var">ATLVar</span></a><span> </span><a name="local-6989586621679152671"><a href="#local-6989586621679152671"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679152672"><a href="#local-6989586621679152672"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152673"><a href="#local-6989586621679152673"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679152674"><a href="#local-6989586621679152674"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152675"><a href="#local-6989586621679152675"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152676"><a href="#local-6989586621679152676"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152671"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152672"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152675"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152673"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679152676"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">S.union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152674"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679152676"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-429"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATBlock"><span class="hs-identifier hs-var">ATBlock</span></a><span> </span><a name="local-6989586621679152677"><a href="#local-6989586621679152677"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152678"><a href="#local-6989586621679152678"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679152679"><a href="#local-6989586621679152679"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152680"><a href="#local-6989586621679152680"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152681"><a href="#local-6989586621679152681"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S.union</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152680"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152680"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679152677"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152678"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679152681"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">S.union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152679"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679152681"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-430"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATStmtExpr"><span class="hs-identifier hs-var">ATStmtExpr</span></a><span> </span><a name="local-6989586621679152682"><a href="#local-6989586621679152682"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152683"><a href="#local-6989586621679152683"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679152684"><a href="#local-6989586621679152684"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679152685"><a href="#local-6989586621679152685"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152686"><a href="#local-6989586621679152686"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATBlock"><span class="hs-identifier hs-var">ATBlock</span></a><span> </span><a href="#local-6989586621679152682"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152683"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679152684"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679152685"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152686"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-431"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATFor"><span class="hs-identifier hs-var">ATFor</span></a><span> </span><a name="local-6989586621679152687"><a href="#local-6989586621679152687"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152688"><a href="#local-6989586621679152688"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679152689"><a href="#local-6989586621679152689"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152690"><a href="#local-6989586621679152690"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152691"><a href="#local-6989586621679152691"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S.union</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152690"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Parser.AST.Core.html#fromATKindFor"><span class="hs-identifier hs-var">fromATKindFor</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">S.empty</span><span> </span><a href="#local-6989586621679152687"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152688"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679152691"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">S.union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152689"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679152691"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-432"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNull"><span class="hs-identifier hs-var">ATNull</span></a><span> </span><a name="local-6989586621679152692"><a href="#local-6989586621679152692"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152693"><a href="#local-6989586621679152693"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152692"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679152693"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-433"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152694"><a href="#local-6989586621679152694"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679152695"><a href="#local-6989586621679152695"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152696"><a href="#local-6989586621679152696"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152694"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679152696"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">S.union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152664"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152695"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679152696"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-434"></a><span class="hs-identifier">stackSize</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a></pre></body></html>