<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Htcc.Visualizer.Core
Description : Build AST from C source code
Copyright   : (c) roki, 2019
License     : MIT
Maintainer  : falgon53@yahoo.co.jp
Stability   : experimental
Portability : POSIX

Build AST from C source code
-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, FlexibleContexts #-}</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Htcc.Visualizer.Core</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>    </span><a href="Htcc.Visualizer.Core.html#visualize"><span class="hs-identifier hs-var">visualize</span></a><span>
</span><a name="line-15"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Tree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Tree</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Diagrams.Prelude</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Diagrams.TwoD.Layout.Tree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">renderTree</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">symmLayout'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">slHSep</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">slVSep</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Diagrams.Backend.SVG</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SVG</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">renderPretty</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.html"><span class="hs-identifier">Htcc.Parser</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Type.html#ASTs"><span class="hs-identifier hs-type">ASTs</span></a><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.CRules.Types.html"><span class="hs-identifier">Htcc.CRules.Types</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CT</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Parser.AST.Core.html"><span class="hs-identifier">Htcc.Parser.AST.Core</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATKind"><span class="hs-identifier hs-type">ATKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Htcc.Parser.AST.Core.html#fromATKindFor"><span class="hs-identifier hs-var">fromATKindFor</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Htcc.Utils.html"><span class="hs-identifier">Htcc.Utils</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Utils.Print.html#putStrLnErr"><span class="hs-identifier hs-var">putStrLnErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- | the function to convert `ATree` to `Data.Tree`</span><span>
</span><a name="line-29"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679229174"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a><span> </span><a href="#local-6989586621679229174"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tree</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-30"></a><a name="encodeTree"><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier">encodeTree</span></a></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;Null&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-31"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAdd"><span class="hs-identifier hs-var">ATAdd</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229175"><a href="#local-6989586621679229175"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229176"><a href="#local-6989586621679229176"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;+&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229175"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229176"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-32"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAddPtr"><span class="hs-identifier hs-var">ATAddPtr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229177"><a href="#local-6989586621679229177"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229178"><a href="#local-6989586621679229178"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;+&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229177"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229178"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-33"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATSub"><span class="hs-identifier hs-var">ATSub</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229179"><a href="#local-6989586621679229179"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229180"><a href="#local-6989586621679229180"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229179"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229180"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-34"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATSubPtr"><span class="hs-identifier hs-var">ATSubPtr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229181"><a href="#local-6989586621679229181"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229182"><a href="#local-6989586621679229182"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229181"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229182"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-35"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPtrDis"><span class="hs-identifier hs-var">ATPtrDis</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229183"><a href="#local-6989586621679229183"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229184"><a href="#local-6989586621679229184"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229183"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229184"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-36"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATMul"><span class="hs-identifier hs-var">ATMul</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229185"><a href="#local-6989586621679229185"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229186"><a href="#local-6989586621679229186"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;*&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229185"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229186"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-37"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATDiv"><span class="hs-identifier hs-var">ATDiv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229187"><a href="#local-6989586621679229187"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229188"><a href="#local-6989586621679229188"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;/&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229187"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229188"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-38"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATMod"><span class="hs-identifier hs-var">ATMod</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229189"><a href="#local-6989586621679229189"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229190"><a href="#local-6989586621679229190"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;%&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229189"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229190"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-39"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAddAssign"><span class="hs-identifier hs-var">ATAddAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229191"><a href="#local-6989586621679229191"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229192"><a href="#local-6989586621679229192"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;+=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229192"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-40"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATSubAssign"><span class="hs-identifier hs-var">ATSubAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229193"><a href="#local-6989586621679229193"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229194"><a href="#local-6989586621679229194"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;-=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229193"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229194"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-41"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATMulAssign"><span class="hs-identifier hs-var">ATMulAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229195"><a href="#local-6989586621679229195"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229196"><a href="#local-6989586621679229196"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;*=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229195"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229196"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-42"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATDivAssign"><span class="hs-identifier hs-var">ATDivAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229197"><a href="#local-6989586621679229197"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229198"><a href="#local-6989586621679229198"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;/=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229197"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229198"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-43"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAddPtrAssign"><span class="hs-identifier hs-var">ATAddPtrAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229199"><a href="#local-6989586621679229199"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229200"><a href="#local-6989586621679229200"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;+=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229199"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229200"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-44"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATSubPtrAssign"><span class="hs-identifier hs-var">ATSubPtrAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229201"><a href="#local-6989586621679229201"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229202"><a href="#local-6989586621679229202"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;-=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229201"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229202"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-45"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATLAnd"><span class="hs-identifier hs-var">ATLAnd</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229203"><a href="#local-6989586621679229203"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229204"><a href="#local-6989586621679229204"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&amp;&amp;&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229203"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229204"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-46"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATLOr"><span class="hs-identifier hs-var">ATLOr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229205"><a href="#local-6989586621679229205"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229206"><a href="#local-6989586621679229206"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;||&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229205"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229206"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-47"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAnd"><span class="hs-identifier hs-var">ATAnd</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229207"><a href="#local-6989586621679229207"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229208"><a href="#local-6989586621679229208"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&amp;&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229207"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229208"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-48"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAndAssign"><span class="hs-identifier hs-var">ATAndAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229209"><a href="#local-6989586621679229209"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229210"><a href="#local-6989586621679229210"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&amp;=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229209"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229210"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-49"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATOr"><span class="hs-identifier hs-var">ATOr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229211"><a href="#local-6989586621679229211"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229212"><a href="#local-6989586621679229212"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;|&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229211"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229212"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-50"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATOrAssign"><span class="hs-identifier hs-var">ATOrAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229213"><a href="#local-6989586621679229213"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229214"><a href="#local-6989586621679229214"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;|=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229213"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229214"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-51"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATXor"><span class="hs-identifier hs-var">ATXor</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229215"><a href="#local-6989586621679229215"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229216"><a href="#local-6989586621679229216"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;^&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229215"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229216"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-52"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATXorAssign"><span class="hs-identifier hs-var">ATXorAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229217"><a href="#local-6989586621679229217"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229218"><a href="#local-6989586621679229218"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;^=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229217"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229218"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-53"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATBitNot"><span class="hs-identifier hs-var">ATBitNot</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229219"><a href="#local-6989586621679229219"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229220"><a href="#local-6989586621679229220"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;~&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229219"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229220"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-54"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATShl"><span class="hs-identifier hs-var">ATShl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229221"><a href="#local-6989586621679229221"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229222"><a href="#local-6989586621679229222"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&lt;&lt;&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229221"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229222"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATShlAssign"><span class="hs-identifier hs-var">ATShlAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229223"><a href="#local-6989586621679229223"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229224"><a href="#local-6989586621679229224"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&lt;&lt;=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229223"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229224"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-56"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATShr"><span class="hs-identifier hs-var">ATShr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229225"><a href="#local-6989586621679229225"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229226"><a href="#local-6989586621679229226"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&gt;&gt;&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229225"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229226"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-57"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATShrAssign"><span class="hs-identifier hs-var">ATShrAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229227"><a href="#local-6989586621679229227"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229228"><a href="#local-6989586621679229228"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&gt;&gt;=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229227"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229228"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-58"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATLT"><span class="hs-identifier hs-var">ATLT</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229229"><a href="#local-6989586621679229229"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229230"><a href="#local-6989586621679229230"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229229"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229230"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-59"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATLEQ"><span class="hs-identifier hs-var">ATLEQ</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229231"><a href="#local-6989586621679229231"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229232"><a href="#local-6989586621679229232"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&lt;=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229231"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229232"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-60"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATGT"><span class="hs-identifier hs-var">ATGT</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229233"><a href="#local-6989586621679229233"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229234"><a href="#local-6989586621679229234"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229233"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229234"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-61"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATGEQ"><span class="hs-identifier hs-var">ATGEQ</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229235"><a href="#local-6989586621679229235"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229236"><a href="#local-6989586621679229236"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&gt;=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229235"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229236"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-62"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATEQ"><span class="hs-identifier hs-var">ATEQ</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229237"><a href="#local-6989586621679229237"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229238"><a href="#local-6989586621679229238"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;==&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229237"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229238"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-63"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATNEQ"><span class="hs-identifier hs-var">ATNEQ</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229239"><a href="#local-6989586621679229239"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229240"><a href="#local-6989586621679229240"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;!=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229239"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229240"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-64"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATNot"><span class="hs-identifier hs-var">ATNot</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229241"><a href="#local-6989586621679229241"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;!&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229241"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-65"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAddr"><span class="hs-identifier hs-var">ATAddr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229242"><a href="#local-6989586621679229242"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&amp;&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229242"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATDeref"><span class="hs-identifier hs-var">ATDeref</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229243"><a href="#local-6989586621679229243"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;*&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229243"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-67"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATAssign"><span class="hs-identifier hs-var">ATAssign</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229244"><a href="#local-6989586621679229244"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229245"><a href="#local-6989586621679229245"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;=&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229244"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229245"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPreInc"><span class="hs-identifier hs-var">ATPreInc</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229246"><a href="#local-6989586621679229246"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229247"><a href="#local-6989586621679229247"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;++ (pre)&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229246"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229247"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-69"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPreDec"><span class="hs-identifier hs-var">ATPreDec</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229248"><a href="#local-6989586621679229248"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229249"><a href="#local-6989586621679229249"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;-- (pre)&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229248"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229249"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-70"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPostInc"><span class="hs-identifier hs-var">ATPostInc</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229250"><a href="#local-6989586621679229250"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229251"><a href="#local-6989586621679229251"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;++ (post)&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229250"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229251"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-71"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATPostDec"><span class="hs-identifier hs-var">ATPostDec</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229252"><a href="#local-6989586621679229252"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229253"><a href="#local-6989586621679229253"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;-- (post)&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229252"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229253"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-72"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNum"><span class="hs-identifier hs-var">ATNum</span></a><span> </span><a name="local-6989586621679229254"><a href="#local-6989586621679229254"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679229255"><a href="#local-6989586621679229255"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679229256"><a href="#local-6989586621679229256"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229257"><a href="#local-6989586621679229257"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679229254"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679229255"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229256"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229257"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-73"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATConditional"><span class="hs-identifier hs-var">ATConditional</span></a><span> </span><a name="local-6989586621679229258"><a href="#local-6989586621679229258"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679229259"><a href="#local-6989586621679229259"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679229260"><a href="#local-6989586621679229260"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;?:&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229258"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229259"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229260"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-74"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATComma"><span class="hs-identifier hs-var">ATComma</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229261"><a href="#local-6989586621679229261"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229262"><a href="#local-6989586621679229262"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229261"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229262"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-75"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATCast"><span class="hs-identifier hs-var">ATCast</span></a><span> </span><a name="local-6989586621679229263"><a href="#local-6989586621679229263"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679229264"><a href="#local-6989586621679229264"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679229263"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n(type cast)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229264"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-76"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATMemberAcc"><span class="hs-identifier hs-var">ATMemberAcc</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229265"><a href="#local-6989586621679229265"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229266"><a href="#local-6989586621679229266"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229265"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229266"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-77"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATReturn"><span class="hs-identifier hs-var">ATReturn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229267"><a href="#local-6989586621679229267"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229268"><a href="#local-6989586621679229268"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;return&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229267"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229268"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-78"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATIf"><span class="hs-identifier hs-var">ATIf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229269"><a href="#local-6989586621679229269"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229270"><a href="#local-6989586621679229270"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;if&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229269"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229270"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-79"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATElse"><span class="hs-identifier hs-var">ATElse</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229271"><a href="#local-6989586621679229271"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229272"><a href="#local-6989586621679229272"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;else&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229271"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229272"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATSwitch"><span class="hs-identifier hs-var">ATSwitch</span></a><span> </span><a name="local-6989586621679229273"><a href="#local-6989586621679229273"><span class="hs-identifier">th</span></a></a><span> </span><a name="local-6989586621679229274"><a href="#local-6989586621679229274"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229275"><a href="#local-6989586621679229275"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229276"><a href="#local-6989586621679229276"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;switch&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229273"><span class="hs-identifier hs-var">th</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229274"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229275"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229276"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-81"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCase"><span class="hs-identifier hs-var">ATCase</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229277"><a href="#local-6989586621679229277"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229278"><a href="#local-6989586621679229278"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229279"><a href="#local-6989586621679229279"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;case &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679229277"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229278"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229279"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-82"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATDefault"><span class="hs-identifier hs-var">ATDefault</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229280"><a href="#local-6989586621679229280"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229281"><a href="#local-6989586621679229281"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;default&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229280"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229281"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-83"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATWhile"><span class="hs-identifier hs-var">ATWhile</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229282"><a href="#local-6989586621679229282"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229283"><a href="#local-6989586621679229283"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;while&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229282"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229283"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-84"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATFor"><span class="hs-identifier hs-var">ATFor</span></a><span> </span><a name="local-6989586621679229284"><a href="#local-6989586621679229284"><span class="hs-identifier">atf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229285"><a href="#local-6989586621679229285"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229286"><a href="#local-6989586621679229286"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;for&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Parser.AST.Core.html#fromATKindFor"><span class="hs-identifier hs-var">fromATKindFor</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679229284"><span class="hs-identifier hs-var">atf</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229285"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229286"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-85"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATBreak"><span class="hs-identifier hs-var">ATBreak</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229287"><a href="#local-6989586621679229287"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229288"><a href="#local-6989586621679229288"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;break&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229287"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229288"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-86"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATContinue"><span class="hs-identifier hs-var">ATContinue</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229289"><a href="#local-6989586621679229289"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229290"><a href="#local-6989586621679229290"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;continue&quot;</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229289"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229290"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-87"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATGoto"><span class="hs-identifier hs-var">ATGoto</span></a><span> </span><a name="local-6989586621679229291"><a href="#local-6989586621679229291"><span class="hs-identifier">lbl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229292"><a href="#local-6989586621679229292"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229293"><a href="#local-6989586621679229293"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;goto &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679229291"><span class="hs-identifier hs-var">lbl</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229292"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229293"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-88"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATLabel"><span class="hs-identifier hs-var">ATLabel</span></a><span> </span><a name="local-6989586621679229294"><a href="#local-6989586621679229294"><span class="hs-identifier">lbl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229295"><a href="#local-6989586621679229295"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229296"><a href="#local-6989586621679229296"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679229294"><span class="hs-identifier hs-var">lbl</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229295"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229296"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-89"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATBlock"><span class="hs-identifier hs-var">ATBlock</span></a><span> </span><a name="local-6989586621679229297"><a href="#local-6989586621679229297"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;{}&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229297"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-90"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATLVar"><span class="hs-identifier hs-var">ATLVar</span></a><span> </span><a name="local-6989586621679229298"><a href="#local-6989586621679229298"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679229299"><a href="#local-6989586621679229299"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229300"><a href="#local-6989586621679229300"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229301"><a href="#local-6989586621679229301"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679229298"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; lvar&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679229299"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229300"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229301"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-91"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATGVar"><span class="hs-identifier hs-var">ATGVar</span></a><span> </span><a name="local-6989586621679229302"><a href="#local-6989586621679229302"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679229303"><a href="#local-6989586621679229303"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229304"><a href="#local-6989586621679229304"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679229305"><a href="#local-6989586621679229305"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679229302"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679229303"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229304"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229305"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-92"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATDefFunc"><span class="hs-identifier hs-var">ATDefFunc</span></a><span> </span><a name="local-6989586621679229306"><a href="#local-6989586621679229306"><span class="hs-identifier">fname</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679229307"><a href="#local-6989586621679229307"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679229308"><a href="#local-6989586621679229308"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679229307"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679229306"><span class="hs-identifier hs-var">fname</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;()&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229308"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-93"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATDefFunc"><span class="hs-identifier hs-var">ATDefFunc</span></a><span> </span><a name="local-6989586621679229309"><a href="#local-6989586621679229309"><span class="hs-identifier">fname</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679229310"><a href="#local-6989586621679229310"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679229311"><a href="#local-6989586621679229311"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679229312"><a href="#local-6989586621679229312"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a><span> </span><a href="#local-6989586621679229311"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679229309"><span class="hs-identifier hs-var">fname</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;(some arguments)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229310"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229312"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-94"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCallFunc"><span class="hs-identifier hs-var">ATCallFunc</span></a><span> </span><a name="local-6989586621679229313"><a href="#local-6989586621679229313"><span class="hs-identifier">fname</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229314"><a href="#local-6989586621679229314"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679229315"><a href="#local-6989586621679229315"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679229313"><span class="hs-identifier hs-var">fname</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;()&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229314"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229315"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-95"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATCallFunc"><span class="hs-identifier hs-var">ATCallFunc</span></a><span> </span><a name="local-6989586621679229316"><a href="#local-6989586621679229316"><span class="hs-identifier">fname</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679229317"><a href="#local-6989586621679229317"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229318"><a href="#local-6989586621679229318"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679229319"><a href="#local-6989586621679229319"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679229316"><span class="hs-identifier hs-var">fname</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;(some arguments)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229317"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229318"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229319"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-96"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><a href="Htcc.Parser.AST.Core.html#ATExprStmt"><span class="hs-identifier hs-var">ATExprStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229320"><a href="#local-6989586621679229320"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229320"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-97"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATStmtExpr"><span class="hs-identifier hs-var">ATStmtExpr</span></a><span> </span><a name="local-6989586621679229321"><a href="#local-6989586621679229321"><span class="hs-identifier">exps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679229322"><a href="#local-6989586621679229322"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679229323"><a href="#local-6989586621679229323"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;({})&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229321"><span class="hs-identifier hs-var">exps</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229322"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">,</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679229323"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span class="hs-identifier">encodeTree</span><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-var">ATNode</span></a><span> </span><span class="hs-special">(</span><a href="Htcc.Parser.AST.Core.html#ATNull"><span class="hs-identifier hs-var">ATNull</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Node</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-identifier">renderNTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Tree</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">QDiagram</span><span> </span><span class="hs-identifier hs-type">SVG</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-identifier hs-type">Any</span><span>
</span><a name="line-101"></a><a name="renderNTree"><a href="Htcc.Visualizer.Core.html#renderNTree"><span class="hs-identifier">renderNTree</span></a></a><span> </span><a name="local-6989586621679229324"><a href="#local-6989586621679229324"><span class="hs-identifier">nt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderTree</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679229452"><a href="#local-6989586621679229452"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679229325"><span class="hs-identifier hs-var">letter</span></a><span> </span><a href="#local-6989586621679229452"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">atop</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">circle</span><span> </span><span class="hs-number">2.5</span><span> </span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-identifier hs-var">fc</span><span> </span><span class="hs-identifier hs-var">white</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator hs-var">~~</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">symmLayout'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">with</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">slHSep</span><span> </span><span class="hs-operator hs-var">.~</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">slVSep</span><span> </span><span class="hs-operator hs-var">.~</span><span> </span><span class="hs-number">6</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679229324"><span class="hs-identifier hs-var">nt</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>        </span><a name="local-6989586621679229325"><a href="#local-6989586621679229325"><span class="hs-identifier">letter</span></a></a><span> </span><a name="local-6989586621679229326"><a href="#local-6989586621679229326"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><a href="#local-6989586621679229326"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-identifier hs-var">font</span><span> </span><span class="hs-string">&quot;monospace&quot;</span><span> </span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-identifier hs-var">fontSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">local</span><span> </span><span class="hs-number">0.7</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-comment">-- | Build AST from C source code</span><span>
</span><a name="line-109"></a><span class="hs-identifier">visualize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679229173"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Htcc.Parser.AST.Type.html#ASTs"><span class="hs-identifier hs-type">ASTs</span></a><span> </span><a href="#local-6989586621679229173"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SizeSpec</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><a name="visualize"><a href="Htcc.Visualizer.Core.html#visualize"><span class="hs-identifier">visualize</span></a></a><span> </span><a name="local-6989586621679230038"><a href="#local-6989586621679230038"><span class="hs-identifier">ast</span></a></a><span> </span><a name="local-6989586621679230039"><a href="#local-6989586621679230039"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621679230040"><a href="#local-6989586621679230040"><span class="hs-identifier">fpath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679230041"><a href="#local-6989586621679230041"><span class="hs-identifier">et</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Htcc.Visualizer.Core.html#encodeTree"><span class="hs-identifier hs-var">encodeTree</span></a><span> </span><a href="#local-6989586621679230038"><span class="hs-identifier hs-var">ast</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679230041"><span class="hs-identifier hs-var">et</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier hs-var">renderPretty</span><span> </span><a href="#local-6989586621679230040"><span class="hs-identifier hs-var">fpath</span></a><span> </span><a href="#local-6989586621679230039"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">|||</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Htcc.Visualizer.Core.html#renderNTree"><span class="hs-identifier hs-var">renderNTree</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Htcc.Visualizer.Core.html#renderNTree"><span class="hs-identifier hs-var">renderNTree</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679230041"><span class="hs-identifier hs-var">et</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679230041"><span class="hs-identifier hs-var">et</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span>
</span><a name="line-112"></a><span>        </span><a href="Htcc.Utils.Print.html#putStrLnErr"><span class="hs-identifier hs-var">putStrLnErr</span></a><span> </span><span class="hs-string">&quot;There is nothing to describe&quot;</span><span>
</span><a name="line-113"></a></pre></body></html>